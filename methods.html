
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Methods &#8212; Benchmark denoising strategies on fMRIPrep outputs</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Results" href="results.html" />
    <link rel="prev" title="Introductions" href="introductions.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint">⚠️This is a working draft for discussion and feedback!⚠️</div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Benchmark denoising strategies on fMRIPrep outputs</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    Overview
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Paper
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="introductions.html">
   Introductions
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Methods
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="results.html">
   Results
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="ds000030.html">
     ds000030
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="discussions.html">
   Discussions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="references.html">
   References
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendices and supplemental material
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="CITATION.html">
   fMRIPrep preprocessing details
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ohbm2022abstract.html">
   OHBM 2022 abstract - submitted text
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/SIMEXP/fmriprep-denoise-benchmark/main?urlpath=tree/content/methods.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/SIMEXP/fmriprep-denoise-benchmark"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/SIMEXP/fmriprep-denoise-benchmark/issues/new?title=Issue%20on%20page%20%2Fmethods.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/methods.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="_sources/methods.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#datasets">
   Datasets
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fmri-data-preprocessing">
   fMRI data preprocessing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#time-series-extraction-and-connectome-generation">
   Time series extraction and connectome generation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#confound-regression-strategies">
   Confound regression strategies
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basic-noise-components">
     Basic noise components
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pre-defined-strategies">
     Pre-defined strategies
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#examined-strategies">
     Examined strategies
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#denoising-evaluation-measures">
   Denoising evaluation measures
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#quality-control-functional-connectivity-qc-fc">
     Quality control / functional connectivity (QC-FC)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#distance-dependent-effects-of-motion-on-connectivity">
     Distance-dependent effects of motion on connectivity
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#network-modularity">
     Network modularity
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Methods</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#datasets">
   Datasets
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fmri-data-preprocessing">
   fMRI data preprocessing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#time-series-extraction-and-connectome-generation">
   Time series extraction and connectome generation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#confound-regression-strategies">
   Confound regression strategies
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basic-noise-components">
     Basic noise components
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pre-defined-strategies">
     Pre-defined strategies
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#examined-strategies">
     Examined strategies
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#denoising-evaluation-measures">
   Denoising evaluation measures
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#quality-control-functional-connectivity-qc-fc">
     Quality control / functional connectivity (QC-FC)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#distance-dependent-effects-of-motion-on-connectivity">
     Distance-dependent effects of motion on connectivity
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#network-modularity">
     Network modularity
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="methods">
<h1>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">#</a></h1>
<section id="datasets">
<h2>Datasets<a class="headerlink" href="#datasets" title="Permalink to this headline">#</a></h2>
<!-- need to revise the demographic information -->
<p>We selected two datasets on OpenNeuro for the current analysis:
<code class="docutils literal notranslate"><span class="pre">ds000228</span></code> <span id="id1">[<a class="reference internal" href="references.html#id27">Richardson <em>et al.</em>, 2019</a>]</span> and <code class="docutils literal notranslate"><span class="pre">ds000030</span></code> <span id="id2">[<a class="reference internal" href="references.html#id26">Bilder <em>et al.</em>, 2020</a>]</span>.
Dataset <code class="docutils literal notranslate"><span class="pre">ds000228</span></code> (<span class="math notranslate nohighlight">\(N=155\)</span>) contains fMRI scans of participants watching a silent version of Pixar animated movie “Partly Cloudy”.
The dataset includes 33 adult subjects
(<span class="math notranslate nohighlight">\(Mean_{age}=24.8\)</span>, <span class="math notranslate nohighlight">\(SD_{age}=5.3\)</span>, <span class="math notranslate nohighlight">\(range_{age}: 18-39\)</span>; <span class="math notranslate nohighlight">\(n_{female}=20\)</span>)
and 122 children subjects
(<span class="math notranslate nohighlight">\(Mean_{age}=6.7\)</span>, <span class="math notranslate nohighlight">\(SD_{age}=2.3\)</span>, <span class="math notranslate nohighlight">\(range_{age}: 3.5-12\)</span>; <span class="math notranslate nohighlight">\(n_{female}=64\)</span>)
For more information for the dataset please refers to <span id="id3">Richardson <em>et al.</em> [<a class="reference internal" href="references.html#id28">2018</a>]</span>.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="kn">from</span> <span class="nn">fmriprep_denoise.visualization</span> <span class="kn">import</span> <span class="n">tables</span>
<span class="n">desc</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">lazy_report</span><span class="p">(</span><span class="s1">&#39;ds000228&#39;</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;ds000228_desc&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n female: 84.0
n female in child: 64.0
n female in adult: 20.0
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>full sample</th>
      <th>child</th>
      <th>adult</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>155.000000</td>
      <td>122.000000</td>
      <td>33.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>10.555189</td>
      <td>6.709461</td>
      <td>24.772727</td>
    </tr>
    <tr>
      <th>std</th>
      <td>8.071957</td>
      <td>2.330938</td>
      <td>5.308521</td>
    </tr>
    <tr>
      <th>min</th>
      <td>3.518138</td>
      <td>3.518138</td>
      <td>18.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>5.300000</td>
      <td>4.895210</td>
      <td>21.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>7.680000</td>
      <td>5.980000</td>
      <td>23.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>10.975000</td>
      <td>8.397500</td>
      <td>28.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>39.000000</td>
      <td>12.300000</td>
      <td>39.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Dataset <code class="docutils literal notranslate"><span class="pre">ds000030</span></code> includes multiple tasks collected on subjects of a variety of neuropsychiatric diagnostics, including ADHD, bipolar disorder, schizophrenia , and healthy controls.
The current analysis only focused on the resting state scans.
Scans with an instrumental artifact (flagged under column <code class="docutils literal notranslate"><span class="pre">ghost_NoGhost</span></code> in <code class="docutils literal notranslate"><span class="pre">particiapnts.tsv</span></code>) were excluded from the analysis pipeline.
259 out of 272 subjects of were included in the benchmark.
The demographic information per condition is in the following table.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:right head"><p></p></th>
<th class="text-align:right head"><p>Full sample</p></th>
<th class="text-align:right head"><p>Healthy control</p></th>
<th class="text-align:right head"><p>Schizophrenia</p></th>
<th class="text-align:right head"><p>Bipolar disorder</p></th>
<th class="text-align:right head"><p>ADHD</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:right"><p>N(female)</p></td>
<td class="text-align:right"><p>259(108)</p></td>
<td class="text-align:right"><p>120(56)</p></td>
<td class="text-align:right"><p>50(12)</p></td>
<td class="text-align:right"><p>49(21)</p></td>
<td class="text-align:right"><p>40(19)</p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>Age Mean(s.d.)</p></td>
<td class="text-align:right"><p>33.3(9.3)</p></td>
<td class="text-align:right"><p>31.7 (8.8)</p></td>
<td class="text-align:right"><p>36.5 (8.9)</p></td>
<td class="text-align:right"><p>35.3 (9.0)</p></td>
<td class="text-align:right"><p>32.1 (10.4)</p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p>Age Range</p></td>
<td class="text-align:right"><p>21–50</p></td>
<td class="text-align:right"><p>21–50</p></td>
<td class="text-align:right"><p>22–49</p></td>
<td class="text-align:right"><p>21–50</p></td>
<td class="text-align:right"><p>21–50</p></td>
</tr>
</tbody>
</table>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="kn">from</span> <span class="nn">fmriprep_denoise.visualization</span> <span class="kn">import</span> <span class="n">tables</span>
<span class="n">desc</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">lazy_report</span><span class="p">(</span><span class="s1">&#39;ds000030&#39;</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;ds000030_desc&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n female: 108.0
n female in ADHD: 19.0
n female in BIPOLAR: 21.0
n female in SCHZ: 12.0
n female in CONTROL: 56.0
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>full sample</th>
      <th>ADHD</th>
      <th>BIPOLAR</th>
      <th>SCHZ</th>
      <th>CONTROL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>259.000000</td>
      <td>40.000000</td>
      <td>49.000000</td>
      <td>50.000000</td>
      <td>120.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>33.347490</td>
      <td>32.050000</td>
      <td>35.285714</td>
      <td>36.460000</td>
      <td>31.691667</td>
    </tr>
    <tr>
      <th>std</th>
      <td>9.305064</td>
      <td>10.409439</td>
      <td>9.027735</td>
      <td>8.878339</td>
      <td>8.827760</td>
    </tr>
    <tr>
      <th>min</th>
      <td>21.000000</td>
      <td>21.000000</td>
      <td>21.000000</td>
      <td>22.000000</td>
      <td>21.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>25.000000</td>
      <td>23.750000</td>
      <td>26.000000</td>
      <td>29.000000</td>
      <td>24.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>32.000000</td>
      <td>28.000000</td>
      <td>36.000000</td>
      <td>37.500000</td>
      <td>28.500000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>41.000000</td>
      <td>40.000000</td>
      <td>43.000000</td>
      <td>43.750000</td>
      <td>39.250000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>50.000000</td>
      <td>50.000000</td>
      <td>50.000000</td>
      <td>49.000000</td>
      <td>50.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="fmri-data-preprocessing">
<h2>fMRI data preprocessing<a class="headerlink" href="#fmri-data-preprocessing" title="Permalink to this headline">#</a></h2>
<p>We preprocessed with fMRIPrep LTS20.2.1 through <a class="reference external" href="https://github.com/SIMEXP/fmriprep-slurm"><code class="docutils literal notranslate"><span class="pre">fMRIPrep-slurm</span></code></a> with the following options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">aroma</span> \
<span class="o">--</span><span class="n">omp</span><span class="o">-</span><span class="n">nthreads</span> <span class="mi">1</span> \
<span class="o">--</span><span class="n">nprocs</span> <span class="mi">1</span> \
<span class="o">--</span><span class="n">random</span><span class="o">-</span><span class="n">seed</span> <span class="mi">0</span>  \
<span class="o">--</span><span class="n">output</span><span class="o">-</span><span class="n">spaces</span> <span class="n">MNI152NLin2009cAsym</span> <span class="n">MNI152NLin6Asym</span> \
<span class="o">--</span><span class="n">output</span><span class="o">-</span><span class="n">layout</span> <span class="n">bids</span> \
<span class="o">--</span><span class="n">notrack</span> \
<span class="o">--</span><span class="n">skip_bids_validation</span> \
<span class="o">--</span><span class="n">write</span><span class="o">-</span><span class="n">graph</span> \
<span class="o">--</span><span class="n">omp</span><span class="o">-</span><span class="n">nthreads</span> <span class="mi">1</span> \
<span class="o">--</span><span class="n">nprocs</span> <span class="mi">1</span> \
<span class="o">--</span><span class="n">resource</span><span class="o">-</span><span class="n">monitor</span>
</pre></div>
</div>
<p>For the full description generated by fMRIPrep, please see <a class="reference internal" href="CITATION.html"><span class="doc std std-doc">supplemental material</span></a>.</p>
</section>
<section id="time-series-extraction-and-connectome-generation">
<h2>Time series extraction and connectome generation<a class="headerlink" href="#time-series-extraction-and-connectome-generation" title="Permalink to this headline">#</a></h2>
<p>We extract time series with regions of interest (ROI) defined by the following atlases:
Gordon atlas <span id="id4">[<a class="reference internal" href="references.html#id31">Gordon <em>et al.</em>, 2014</a>]</span>,
Schaefer 7 network atlas <span id="id5">[<a class="reference internal" href="references.html#id29">Schaefer <em>et al.</em>, 2017</a>]</span>,
Multiresolution Intrinsic Segmentation Template (MIST) <span id="id6">[<a class="reference internal" href="references.html#id32">Urchs <em>et al.</em>, 2019</a>]</span>,
and Dictionary of Functional Modes (DiFuMo)<span id="id7">[<a class="reference internal" href="references.html#id30">Dadi <em>et al.</em>, 2020</a>]</span>.
All atlases were resampled to the resolution of the preprocessed functional data.</p>
<p>Further ROI extraction was done on DiFuMo and MIST,
because area under the same label can be networks with disjointed regions.
We present the labels with the original number of parcel,
and denote the number of extracted ROI in brackets.
Gordon and Schaefer atlas both comes with parcels as isolated ROI hence were applied as it is in the extraction.
Schaefer 1000 parcels atlas was excluded as some regions would be dropped after resampling.</p>
<ul class="simple">
<li><p>Gordon atlas: 333</p></li>
<li><p>Schaefer atlas: 100, 200, 300, 400, 500, 600, 800<a class="footnote-reference brackets" href="#id29" id="id8">1</a></p></li>
<li><p>Multiresolution Intrinsic Segmentation Template (MIST) <span id="id9">[<a class="reference internal" href="references.html#id32">Urchs <em>et al.</em>, 2019</a>]</span>: 7, 12, 20, 36, 64, 122, 197, 325, 444, “ROI” (210 parcels, 122 split by the midline)</p></li>
<li><p>DiFuMo atlas <span id="id10">[<a class="reference internal" href="references.html#id30">Dadi <em>et al.</em>, 2020</a>]</span>: 64 (114), 128 (200), 256 (372), 512 (637), 1024 (1158)</p></li>
</ul>
<p>Process involved here are implemented through nilearn <span id="id11">[<a class="reference internal" href="references.html#id20">Abraham <em>et al.</em>, 2014</a>]</span>.
Time series were extracted using <code class="docutils literal notranslate"><span class="pre">nilearn.maskers.NiftiLabelsMasker</span></code> and <code class="docutils literal notranslate"><span class="pre">nilearn.maskers.NiftiMapsMasker</span></code>.
Connectomes were calculated using Pearson’s Correlations, implemented through <code class="docutils literal notranslate"><span class="pre">nilearn.connectome.ConnectivityMeasure</span></code>.</p>
</section>
<section id="confound-regression-strategies">
<h2>Confound regression strategies<a class="headerlink" href="#confound-regression-strategies" title="Permalink to this headline">#</a></h2>
<p>Confound variables were retrieved using API
<code class="docutils literal notranslate"><span class="pre">nilearn.interfaces.fmriprep.load_confounds</span></code> (simplified as <code class="docutils literal notranslate"><span class="pre">load_confounds</span></code>),
the basic API that retrieves different classes of confound regressor,
and <code class="docutils literal notranslate"><span class="pre">nilearn.interfaces.fmriprep.load_confounds_strategy</span></code>(simplified as <code class="docutils literal notranslate"><span class="pre">load_confounds_strategy</span></code>),
a higher level wrapper to implement common strategies from the denoising literature.
The current section describes the logic behind the design of API.
For documentation of the actual function, please see the latest version of <code class="docutils literal notranslate"><span class="pre">nilearn</span></code>.</p>
<section id="basic-noise-components">
<h3>Basic noise components<a class="headerlink" href="#basic-noise-components" title="Permalink to this headline">#</a></h3>
<p>To enable easy confound variables loading from fMRIPrep outputs,
<code class="docutils literal notranslate"><span class="pre">load_confounds</span></code> provides an interface that groups subsets of confound variables into noise components and their parameters.
It is possible to fine-tune a subset of noise components and their parameters through this function.
The implementation will only support fMRIPrep functional derivative directory from the 1.2.x series. The compcor noise component requires 1.4.x series or above.</p>
<!-- Explain the logic of nilearn API mirror the intro -->
<p>Two types of regressors are always loaded with no additional parameters for user customisation:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">high_pass</span></code>: discrete cosines transformation basis regressors to handle low-frequency signal drifts.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">non_steady_state</span></code> denotes volumes collected before the fMRI scanner has reached a stable state.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">motion</span></code>, <code class="docutils literal notranslate"><span class="pre">wm_csf</span></code>, and <code class="docutils literal notranslate"><span class="pre">global_signal</span></code> shares similar expansion options:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">motion</span></code>: head motion estimates translation/rotation (6 parameters).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wm_csf</span></code>: average signal extracted from masks of white matter and cerebrospinal fluids (2 parameters).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">global_signal</span></code>: average signal extracted from brain mask (1 parameters).</p></li>
</ul>
<p>For these three parameters above, user can select from the following four options:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">basic</span></code>: just the original signal (n parameter)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">power2</span></code>: original signal and quadratic term (2 * n parameters)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">derivatives</span></code>: original signal and temporal derivative (2 * n parameters)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">full</span></code>:  original signal + temporal derivatives + quadratic terms + quadratic terms temporal derivatives (4 * n parameters)</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">scrub</span></code> generates mask to exclude volumes with excessive motion <span id="id12">[<a class="reference internal" href="references.html#id15">Power <em>et al.</em>, 2012</a>]</span>.
Two types of parameters can be used to determined volumes to be excluded.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fd_threshold</span></code>: set the head motion cut-off value determined by framewise displacement approach <span id="id13">[<a class="reference internal" href="references.html#id15">Power <em>et al.</em>, 2012</a>]</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">std_dvars_threshold</span></code>: set the head motion cut-off value determined by the standard deviation of root mean square approach <span id="id14">[<a class="reference internal" href="references.html#id15">Power <em>et al.</em>, 2012</a>, <a class="reference internal" href="references.html#id23">Jenkinson <em>et al.</em>, 2002</a>]</span>.</p></li>
</ul>
<p>The CompCor <span id="id15">[<a class="reference internal" href="references.html#id16">Behzadi <em>et al.</em>, 2007</a>]</span> approach has two associated parameters</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">compcor</span></code> allows users to select components generated by the temporal approach,
or the anatomical approach with specific details for the mask used in noise signal extraction.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_compcor</span></code> retrieves the number of principle components to retrieve.</p></li>
</ul>
<p>For the ICA-based approach, fMRIPrep implemented ICA-AROMA <span id="id16">[<a class="reference internal" href="references.html#id51">Pruim <em>et al.</em>, 2015</a>]</span>.
User must manually enable ICA-AROMA with flag <code class="docutils literal notranslate"><span class="pre">--use-aroma</span></code> when using fMRIPrep.
The parameter <code class="docutils literal notranslate"><span class="pre">ica_aroma</span></code> allows two approaches:</p>
<ol class="simple">
<li><p>Use fMRIPrep output with suffix <code class="docutils literal notranslate"><span class="pre">desc-smoothAROMAnonaggr_bold.nii.gz</span></code>.</p></li>
<li><p>Use noise independent components only. Must be used with output with suffix <code class="docutils literal notranslate"><span class="pre">desc-preproc_bold.nii.gz</span></code>.</p></li>
</ol>
</section>
<section id="pre-defined-strategies">
<h3>Pre-defined strategies<a class="headerlink" href="#pre-defined-strategies" title="Permalink to this headline">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">load_confounds_strategy</span></code> provides an interface to select confounds based on past literature with limited parameters for user customisation:
<code class="docutils literal notranslate"><span class="pre">simple</span></code> <span id="id17">[<a class="reference internal" href="references.html#id14">Fox <em>et al.</em>, 2005</a>]</span> (motion parameters, and tissue signal),
<code class="docutils literal notranslate"><span class="pre">scrubbing</span></code> <span id="id18">[<a class="reference internal" href="references.html#id15">Power <em>et al.</em>, 2012</a>]</span>(volume censoring, motion parameters, and tissue signal),
<code class="docutils literal notranslate"><span class="pre">compcor</span></code> <span id="id19">[<a class="reference internal" href="references.html#id16">Behzadi <em>et al.</em>, 2007</a>]</span>(anatomical compcor and motion parameters),
and <code class="docutils literal notranslate"><span class="pre">aroma</span></code> <span id="id20">[<a class="reference internal" href="references.html#id51">Pruim <em>et al.</em>, 2015</a>]</span>(ICA-AROMA based denoising, and tissue signal).
All strategies but <code class="docutils literal notranslate"><span class="pre">compcor</span></code> provides an option to add global signal to the confound regressors.</p>
</section>
<section id="examined-strategies">
<h3>Examined strategies<a class="headerlink" href="#examined-strategies" title="Permalink to this headline">#</a></h3>
<p>We evaluated common confound regression strategies that are possible through fMRIPrep generated confound regressors.
Subjects with high motion, indicated by less than 80% of remaining volumes after scrubbing with a 0.5 mm threshold, were excluded from all analysis.
The connectome generated from high-pass filtered time series were served as a comparison baseline.
Confound variables were accessed using API <code class="docutils literal notranslate"><span class="pre">load_confounds_strategy</span></code>.
The detailed 11 strategies and a full breakdown of parameters used under the hood is presented in the table below.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>strategy</p></th>
<th class="head"><p>image</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">high_pass</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">motion</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">wm_csf</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">global_signal</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">scrub</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">fd_thresh</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">compcor</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">n_compcor</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">ica_aroma</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">demean</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>baseline</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>simple</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-even"><td><p>simple+gsr</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>scrubbing.5</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p>N/A</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.5</span></code></p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-even"><td><p>scrubbing.5+gsr</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.5</span></code></p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>scrubbing.2</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p>N/A</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.2</span></code></p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-even"><td><p>scrubbing.2+gsr</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.2</span></code></p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>compcor</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">anat_combined</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">all</span></code></p></td>
<td><p>N/A</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-even"><td><p>compcor6</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">anat_combined</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">6</span> </code></p></td>
<td><p>N/A</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>aroma</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">desc-smoothAROMAnonaggr_bold</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p>N/A</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-even"><td><p>aroma+gsr</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">desc-smoothAROMAnonaggr_bold</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p>N/A</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="denoising-evaluation-measures">
<h2>Denoising evaluation measures<a class="headerlink" href="#denoising-evaluation-measures" title="Permalink to this headline">#</a></h2>
<p>We used three metrics <span id="id21">[<a class="reference internal" href="references.html#id17">Ciric <em>et al.</em>, 2017</a>]</span>, <span id="id22">[<a class="reference internal" href="references.html#id19">Parkes <em>et al.</em>, 2018</a>]</span> described in the previous literature to evaluate the denoising results.
Motion related metrics are centred around framewise displacement.
Framewise displacement (FD) indexes the movement of the head from one volume to the next.
The movement includes the transitions on the three axes (<span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, <span class="math notranslate nohighlight">\(z\)</span>) and the respective rotation (<span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\beta_t\)</span>, <span class="math notranslate nohighlight">\(\gamma\)</span>).
Rotational displacements are calculated as the displacement on the surface of a sphere of radius 50 mm <span id="id23">[<a class="reference internal" href="references.html#id15">Power <em>et al.</em>, 2012</a>]</span>.
fMRIPrep genetates the FD based on the formula proposed in <span id="id24">[<a class="reference internal" href="references.html#id15">Power <em>et al.</em>, 2012</a>]</span>.
The FD at each time point <span class="math notranslate nohighlight">\(t\)</span> is expressed as:</p>
<div class="math notranslate nohighlight">
\[
\text{FD}_t = |\Delta d_{x,t}| + |\Delta d_{y,t}| +
|\Delta d_{z,t}| + |\Delta \alpha_t| + |\Delta \beta_t| + |\Delta \gamma_t|
\]</div>
<p>The details of each measures are explained as followed.</p>
<section id="quality-control-functional-connectivity-qc-fc">
<h3>Quality control / functional connectivity (QC-FC)<a class="headerlink" href="#quality-control-functional-connectivity-qc-fc" title="Permalink to this headline">#</a></h3>
<p>QC-FC <span id="id25">[<a class="reference internal" href="references.html#id24">Power <em>et al.</em>, 2015</a>]</span> quantifies the correlation between mean FD and functional connectivity.
This is calculated by a partial correlation between mean FD and connectivity with age and sex as covariates.
The denoising methods should aim to reduce the QC-FC value.
The significants values reported are control for multiple comparisons with false positive rate correction.</p>
</section>
<section id="distance-dependent-effects-of-motion-on-connectivity">
<h3>Distance-dependent effects of motion on connectivity<a class="headerlink" href="#distance-dependent-effects-of-motion-on-connectivity" title="Permalink to this headline">#</a></h3>
<p>To determine the residual distance-dependence of subject movement,
we first calculate the Euclidean distance between the centers of mass of ecah pair of parcels <span id="id26">[<a class="reference internal" href="references.html#id15">Power <em>et al.</em>, 2012</a>]</span>.
We then correlated the distance separating each pair of parcels and the associated QC-FC correlation of the edge connecting those parcels.
Closer parcels generally exhibiting greater impact of motion on connectivity.
We expect to see a general trend of negative correlation to no correlation after confound regression.</p>
</section>
<section id="network-modularity">
<h3>Network modularity<a class="headerlink" href="#network-modularity" title="Permalink to this headline">#</a></h3>
<p>Confound regressors has the potential to remove real signal in addition to motion-related noise.
In order to evaluate this possibility, we computed modularity quality,
an explicit quantification of the degree to which there are structured sub-networks in a given network,
in this case the de-noised connectome <span id="id27">[<a class="reference internal" href="references.html#id22">Satterthwaite <em>et al.</em>, 2012</a>]</span>.
Modularity quality is quantified by graph community detection based on Louvain method <span id="id28">[<a class="reference internal" href="references.html#id25">Rubinov and Sporns, 2010</a>]</span>,
implemented in the Brain Connectome Toolbox.
If confound regression and censoring were removing real signal in addition to motion-related noise,
we expect that modularity would decline.
To understand the extend of correlation between modularity and motion.
we computed the partial correlation between subjects’ modularity values and mean FD,
with age and sex as covariates.</p>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="id29"><span class="brackets"><a class="fn-backref" href="#id8">1</a></span></dt>
<dd><p>When resampling 1000 parcel version of the Schaefer atlas to match the preprocessed data,
some subjects will miss a parcel.</p>
</dd>
</dl>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="introductions.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Introductions</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="results.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Results</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Hao-Ting Wang<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>