Traceback (most recent call last):
  File "/home/haoting/.virtualenvs/connectome_confounds/lib/python3.8/site-packages/jupyter_cache/executors/utils.py", line 51, in single_nb_execution
    executenb(
  File "/home/haoting/.virtualenvs/connectome_confounds/lib/python3.8/site-packages/nbclient/client.py", line 1093, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/home/haoting/.virtualenvs/connectome_confounds/lib/python3.8/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/home/haoting/.virtualenvs/connectome_confounds/lib/python3.8/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/usr/lib/python3.8/asyncio/base_events.py", line 616, in run_until_complete
    return future.result()
  File "/home/haoting/.virtualenvs/connectome_confounds/lib/python3.8/site-packages/nbclient/client.py", line 559, in async_execute
    await self.async_execute_cell(
  File "/home/haoting/.virtualenvs/connectome_confounds/lib/python3.8/site-packages/nbclient/client.py", line 854, in async_execute_cell
    self._check_raise_for_error(cell, exec_reply)
  File "/home/haoting/.virtualenvs/connectome_confounds/lib/python3.8/site-packages/nbclient/client.py", line 756, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
pairwise_distance = pairwise_distance.apply(zscore)
metric_per_edge = metric_per_edge.apply(zscore)
corr_distance = np.corrcoef(pairwise_distance.iloc[:, -1], metric_per_edge.T)[1:, 0]
corr_distance = pd.DataFrame(corr_distance, index=metric_per_edge.columns)
long_qcfc['distance'] = np.tile(pairwise_distance.iloc[:, -1].values, 9)

ax = sns.barplot(data=corr_distance.T, ci=None)
ax.set_xticklabels(ax.get_xticklabels(), rotation=90)
ax.set_title("Distance-dependent effects of motion")
ax.set(ylabel="Nodewise correlation between\nEuclidian distance and QC-FC metric",
        xlabel="confound removal strategy")

g = sns.FacetGrid(long_qcfc, col="col", row="row", col_wrap=4, height=3.5)
g.map(sns.regplot, 'distance', 'qcfc', fit_reg=True, ci=None, 
      line_kws={'color': 'red'}, scatter_kws={'s': 0.5, 'alpha': 0.15,})
g.refline(y=0)
for i, name in zip(range(9), metric_per_edge.columns):
    axis_i = int(i / 3)
    axis_j = i % 3
    g.facet_axis(axis_i, axis_j).set(title=name)

g.fig.subplots_adjust(top=0.9) 
g.fig.suptitle('Distribution of correlation between framewise distplacement and edge strength.')
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mValueError[0m                                Traceback (most recent call last)
[0;32m/tmp/ipykernel_70526/251574252.py[0m in [0;36m<module>[0;34m[0m
[1;32m     11[0m         xlabel="confound removal strategy")
[1;32m     12[0m [0;34m[0m[0m
[0;32m---> 13[0;31m [0mg[0m [0;34m=[0m [0msns[0m[0;34m.[0m[0mFacetGrid[0m[0;34m([0m[0mlong_qcfc[0m[0;34m,[0m [0mcol[0m[0;34m=[0m[0;34m"col"[0m[0;34m,[0m [0mrow[0m[0;34m=[0m[0;34m"row"[0m[0;34m,[0m [0mcol_wrap[0m[0;34m=[0m[0;36m4[0m[0;34m,[0m [0mheight[0m[0;34m=[0m[0;36m3.5[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m     14[0m g.map(sns.regplot, 'distance', 'qcfc', fit_reg=True, ci=None, 
[1;32m     15[0m       line_kws={'color': 'red'}, scatter_kws={'s': 0.5, 'alpha': 0.15,})

[0;32m~/.virtualenvs/connectome_confounds/lib/python3.8/site-packages/seaborn/_decorators.py[0m in [0;36minner_f[0;34m(*args, **kwargs)[0m
[1;32m     44[0m             )
[1;32m     45[0m         [0mkwargs[0m[0;34m.[0m[0mupdate[0m[0;34m([0m[0;34m{[0m[0mk[0m[0;34m:[0m [0marg[0m [0;32mfor[0m [0mk[0m[0;34m,[0m [0marg[0m [0;32min[0m [0mzip[0m[0;34m([0m[0msig[0m[0;34m.[0m[0mparameters[0m[0;34m,[0m [0margs[0m[0;34m)[0m[0;34m}[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0;32m---> 46[0;31m         [0;32mreturn[0m [0mf[0m[0;34m([0m[0;34m**[0m[0mkwargs[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m     47[0m     [0;32mreturn[0m [0minner_f[0m[0;34m[0m[0;34m[0m[0m
[1;32m     48[0m [0;34m[0m[0m

[0;32m~/.virtualenvs/connectome_confounds/lib/python3.8/site-packages/seaborn/axisgrid.py[0m in [0;36m__init__[0;34m(self, data, row, col, hue, col_wrap, sharex, sharey, height, aspect, palette, row_order, col_order, hue_order, hue_kws, dropna, legend_out, despine, margin_titles, xlim, ylim, subplot_kws, gridspec_kws, size)[0m
[1;32m    380[0m             [0;32mif[0m [0mrow[0m [0;32mis[0m [0;32mnot[0m [0;32mNone[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    381[0m                 [0merr[0m [0;34m=[0m [0;34m"Cannot use `row` and `col_wrap` together."[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 382[0;31m                 [0;32mraise[0m [0mValueError[0m[0;34m([0m[0merr[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    383[0m             [0mncol[0m [0;34m=[0m [0mcol_wrap[0m[0;34m[0m[0;34m[0m[0m
[1;32m    384[0m             [0mnrow[0m [0;34m=[0m [0mint[0m[0;34m([0m[0mnp[0m[0;34m.[0m[0mceil[0m[0;34m([0m[0mlen[0m[0;34m([0m[0mcol_names[0m[0;34m)[0m [0;34m/[0m [0mcol_wrap[0m[0;34m)[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m

[0;31mValueError[0m: Cannot use `row` and `col_wrap` together.
ValueError: Cannot use `row` and `col_wrap` together.

