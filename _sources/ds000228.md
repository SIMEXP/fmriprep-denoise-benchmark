---
jupytext:
  formats: ipynb,md:myst
  text_representation:
    extension: .md
    format_name: myst
    format_version: 0.13
    jupytext_version: 1.11.5
kernelspec:
  display_name: Python 3 (ipykernel)
  language: python
  name: python3
---

# ds000228

```{code-cell} ipython3
:tags: [hide-input, hide-output]
import warnings
warnings.filterwarnings("ignore")
from fmriprep_denoise.visualization import figures
from myst_nb import glue


# Load metric data
dataset = "ds000228"
atlas_name = "difumo"
dimension = 128

fig = figures.plot_motion_resid(dataset, atlas_name, dimension)
glue(f"{dataset}_{atlas_name}-{dimension}_qcfc-fig", fig, display=False)

fig = figures.plot_distance_dependence(dataset, atlas_name, dimension)
glue(f"{dataset}_{atlas_name}-{dimension}_dist-fig", fig, display=False)

fig = figures.plot_network_modularity(dataset, atlas_name, dimension)
glue(f"{dataset}_{atlas_name}-{dimension}_network-fig", fig, display=False)
```

#### QC-FC and distance-dependent effect

No denoise strategy removed the correlation with motion captured by mean framewise displacement. 
`aroma`, `compcor6`, and `simple` reduced the correlation between connectivity edges and mean framewise displacement. 
`scrubbing` and `scrubbing+gsr` performed the best, as seen in previous work {cite:p}`power_recent_2015`. 
`compcor`, which applies compcor-based regressors covering 50% of the variance, performs worse than the connectome baseline created with high-pass filtered time series. 
Surprisingly, all strategies with global signal regression underperform, contradicting the existing literature {cite:p}`ciric_benchmarking_2017` {cite:p}`parkes_evaluation_2018`.

```{glue:figure} ds000228_difumo-128_qcfc-fig
:figwidth: 800px
:name: "ds000228_difumo-128_qcfc-fig"
```

#### Distance-dependent effects of motion on connectivity

Consistent with the literature, `aroma` reduces the distance dependency of motion on connectivity. 

```{glue:figure} ds000228_difumo-128_dist-fig
:figwidth: 800px
:name: ds000228_difumo-128_dist-fig"
```

#### Network modularity

All strategies increased the overall network modularity compared to the `baseline`, with scrubbing based methods performing the best out of all. 
GSR-based strategies improved the network modularity compared to their conunterparts.
The correlation between modularity quality and motion for each denoising approach shows that compcor-based and ICA-AROMA strategies are the best at eliminating correlations between motion and modularity.

```{glue:figure} ds000228_difumo-128_network-fig
:figwidth: 800px
:name: "ds000228_difumo-128_network-fig"
