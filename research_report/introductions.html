
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Introductions &#8212; Benchmark denoising strategies on fMRIPrep outputs</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Methods" href="methods.html" />
    <link rel="prev" title="Abstract" href="../index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint">⚠️This is a working draft for discussion and feedback!⚠️</div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Benchmark denoising strategies on fMRIPrep outputs</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Abstract
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Research report
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Introductions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="methods.html">
   Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="results.html">
   Results
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="discussions.html">
   Discussions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="contributions.html">
   Contributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="references.html">
   References
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendices and supplemental material
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../supplementary_materials/CITATION.html">
   fMRIPrep preprocessing details
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../supplementary_materials/report_ds000228.html">
   ds000228
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../supplementary_materials/report_ds000030.html">
   ds000030
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../supplementary_materials/ohbm2022abstract.html">
   OHBM 2022 abstract - submitted text
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Workflow documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/tldr.html">
   Quick start
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/setup.html">
   Setup to run all customised scripts for preprocessing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/fmriprep.html">
   Preprocessing fMRI data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/timeseires_metrics.html">
   Generate the reports
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/SIMEXP/fmriprep-denoise-benchmark"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/SIMEXP/fmriprep-denoise-benchmark/issues/new?title=Issue%20on%20page%20%2Fresearch_report/introductions.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/research_report/introductions.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#types-of-noise-regressors">
   Types of noise regressors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementation-of-denoising-step">
   Implementation of denoising step
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#aim-of-the-benchmark">
   Aim of the benchmark
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Introductions</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#types-of-noise-regressors">
   Types of noise regressors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementation-of-denoising-step">
   Implementation of denoising step
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#aim-of-the-benchmark">
   Aim of the benchmark
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="introductions">
<h1>Introductions<a class="headerlink" href="#introductions" title="Permalink to this headline">#</a></h1>
<!-- aim of the paragraph: We all know denoising is important now. And we cannot understand brain activity without it. -->
<p>Amongst functional magnetic resonance imaging (fMRI) acquisition protocols,
resting-state fMRI has become a tool of choice to explore human brain function in healthy and diseased populations <span id="id1">[<a class="reference internal" href="references.html#id2" title="Bharat B. Biswal, Maarten Mennes, Xi-Nian Zuo, Suril Gohel, Clare Kelly, Steve M. Smith, Christian F. Beckmann, Jonathan S. Adelstein, Randy L. Buckner, Stan Colcombe, Anne-Marie Dogonowski, Monique Ernst, Damien Fair, Michelle Hampson, Matthew J. Hoptman, James S. Hyde, Vesa J. Kiviniemi, Rolf Kötter, Shi-Jiang Li, Ching-Po Lin, Mark J. Lowe, Clare Mackay, David J. Madden, Kristoffer H. Madsen, Daniel S. Margulies, Helen S. Mayberg, Katie McMahon, Christopher S. Monk, Stewart H. Mostofsky, Bonnie J. Nagel, James J. Pekar, Scott J. Peltier, Steven E. Petersen, Valentin Riedl, Serge A. R. B. Rombouts, Bart Rypma, Bradley L. Schlaggar, Sein Schmidt, Rachael D. Seidler, Greg J. Siegle, Christian Sorg, Gao-Jun Teng, Juha Veijola, Arno Villringer, Martin Walter, Lihong Wang, Xu-Chu Weng, Susan Whitfield-Gabrieli, Peter Williamson, Christian Windischberger, Yu-Feng Zang, Hong-Ying Zhang, F. Xavier Castellanos, and Michael P. Milham. Toward discovery science of human brain function. Proceedings of the National Academy of Sciences, 107(10):4734-4739, 2010. doi:10.1073/pnas.0911855107.">Biswal <em>et al.</em>, 2010</a>]</span>.
Functional connectivity <span id="id2">[<a class="reference internal" href="references.html#id3" title="Olaf Sporns, Dante R. Chialvo, Marcus Kaiser, and Claus C. Hilgetag. Organization, development and function of complex brain networks. Trends in Cognitive Sciences, 8(9):418–425, September 2004. doi:10.1016/j.tics.2004.07.008.">Sporns <em>et al.</em>, 2004</a>]</span>,
a measure derived from resting-state fMRI, is in particular a popular method to characterize the neural basis of <!-- any suggestions of some newer paper to cite is good. -->
cognitive function <span id="id3">[<a class="reference internal" href="references.html#id4" title="Emily S. Finn, Xilin Shen, Dustin Scheinost, Monica D. Rosenberg, Jessica Huang, Marvin M Chun, Xenophon Papademetris, R Todd Constable, R. Todd Constable, and R Todd Constable. Functional connectome fingerprinting: identifying individuals using patterns of brain connectivity. Nature Neuroscience, 18(October):1–11, October 2015. doi:10.1038/nn.4135.">Finn <em>et al.</em>, 2015</a>]</span>,
aging <span id="id4">[<a class="reference internal" href="references.html#id6" title="Jessica R. Andrews-Hanna, Abraham Z. Snyder, Justin L. Vincent, Cindy Lustig, Denise Head, Marcus E. Raichle, and Randy L. Buckner. Disruption of Large-Scale Brain Systems in Advanced Aging. Neuron, 56(5):924–935, December 2007. doi:10.1016/j.neuron.2007.10.038.">Andrews-Hanna <em>et al.</em>, 2007</a>]</span>,
and pathology <span id="id5">[<a class="reference internal" href="references.html#id5" title="Neil D. Woodward and Carissa J. Cascio. Resting-state functional connectivity in psychiatric disorders. JAMA psychiatry, 72(8):743–744, August 2015. doi:10.1001/jamapsychiatry.2015.0484.">Woodward and Cascio, 2015</a>]</span>.
The rise in popularity of resting-state fMRI has also highlighted challenges and gaps in the analytic approach <span id="id6">[<a class="reference internal" href="references.html#id7" title="David M. Cole, Stephen M. Smith, and Christian F. Beckmann. Advances and pitfalls in the analysis and interpretation of resting-state FMRI data. Frontiers in Systems Neuroscience, 4:8, 2010. doi:10.3389/fnsys.2010.00008.">Cole <em>et al.</em>, 2010</a>]</span>,
such as distortion introduced by non-neuronal sources.
These include head motion, scanner noise, cardiac and repiratory artifacts <span id="id7">[<a class="reference internal" href="references.html#id9" title="Kevin Murphy, Rasmus M. Birn, and Peter A. Bandettini. Resting-state fmri confounds and cleanup. NeuroImage, 80:349-359, 2013. Mapping the Connectome. doi:10.1016/j.neuroimage.2013.04.001.">Murphy <em>et al.</em>, 2013</a>, <a class="reference internal" href="references.html#id8" title="Baxter P. Rogers, Victoria L. Morgan, Allen T. Newton, and John C. Gore. Assessing Functional Connectivity in the Human Brain by FMRI. Magnetic resonance imaging, 25(10):1347–1357, December 2007. doi:10.1016/j.mri.2007.03.007.">Rogers <em>et al.</em>, 2007</a>]</span>.
Known as confounds or nuisance regressors, they pose a major challenge in functional connectivity analysis <span id="id8">[<a class="reference internal" href="references.html#id22" title="Theodore D. Satterthwaite, Daniel H. Wolf, James Loughead, Kosha Ruparel, Mark A. Elliott, Hakonarson Hakon, Ruben C. Gur, and Raquel E. Gur. Impact of In-Scanner Head Motion on Multiple Measures of Functional Connectivity: Relevance for Studies of Neurodevelopment in Youth. NeuroImage, 60(1):623–632, March 2012. doi:10.1016/j.neuroimage.2011.12.063.">Satterthwaite <em>et al.</em>, 2012</a>]</span>.
For example, when functional connectivity is contaminated with motion, it can lead to altered network structure <span id="id9">[<a class="reference internal" href="references.html#id14" title="Jonathan D. Power, Kelly A. Barnes, Abraham Z. Snyder, Bradley L. Schlaggar, and Steven E. Petersen. Spurious but systematic correlations in functional connectivity MRI networks arise from subject motion. NeuroImage, 59(3):2142–2154, 2012. doi:10.1016/j.neuroimage.2011.10.018.">Power <em>et al.</em>, 2012</a>]</span>.
Indeed, in younger subjects and neurologic/psychiatric patients the impact of head motion on connectivity is frequently reported <span id="id10">[<a class="reference internal" href="references.html#id10" title="Carolina Makowski, Martin Lepage, and Alan C. Evans. Head motion: the dirty little secret of neuroimaging in psychiatry. Journal of Psychiatry and Neuroscience, 44(1):62–68, January 2019. doi:10.1503/jpn.180022.">Makowski <em>et al.</em>, 2019</a>, <a class="reference internal" href="references.html#id22" title="Theodore D. Satterthwaite, Daniel H. Wolf, James Loughead, Kosha Ruparel, Mark A. Elliott, Hakonarson Hakon, Ruben C. Gur, and Raquel E. Gur. Impact of In-Scanner Head Motion on Multiple Measures of Functional Connectivity: Relevance for Studies of Neurodevelopment in Youth. NeuroImage, 60(1):623–632, March 2012. doi:10.1016/j.neuroimage.2011.12.063.">Satterthwaite <em>et al.</em>, 2012</a>]</span>.
Hence, reducing the impact of confounds, known as denoising,
is a major component of the fMRI workflow to ensure the quality of analysis.</p>
<div class="section" id="types-of-noise-regressors">
<h2>Types of noise regressors<a class="headerlink" href="#types-of-noise-regressors" title="Permalink to this headline">#</a></h2>
<!-- aim of the paragraph: Classes of nuisance regressors - like how load_confounds separate them -->
<p>The most common method to minimize the impact of confounds in functional connectivity analysis is to perform a linear regression <span id="id11">[<a class="reference internal" href="references.html#id11" title="Karl J. Friston, A. P. Holmes, K. J. Worsley, J. ‐P Poline, Chris D Frith, and R. S.J. J Frackowiak. Statistical parametric maps in functional imaging: A general linear approach. Human Brain Mapping, 2(4):189–210, January 1994. doi:10.1002/hbm.460020402.">Friston <em>et al.</em>, 1994</a>]</span>.
After basic processing steps (see fMRIPrep <span id="id12">[<a class="reference internal" href="references.html#id38" title="Oscar Esteban, Christopher Markiewicz, Ross W Blair, Craig Moodie, Ayse Ilkay Isik, Asier Erramuzpe Aliaga, James Kent, Mathias Goncalves, Elizabeth DuPre, Madeleine Snyder, Hiroyuki Oya, Satrajit Ghosh, Jessey Wright, Joke Durnez, Russell Poldrack, and Krzysztof Jacek Gorgolewski. fMRIPrep: a robust preprocessing pipeline for functional MRI. Nature Methods, 2018. doi:10.1038/s41592-018-0235-4.">Esteban <em>et al.</em>, 2018</a>]</span>),
regressors are regressed out from the signal and the resulting residual used as a denoised signal in all subsequent analyses.
Nuisance regressors can be separated into classes, capturing different types of non-neuronal noise.
<strong>Head motion</strong> is captured by motion realignment measures: <em>6 rigid-body motion parameters</em> (3 translations and 3 rotation) estimated relative to a reference image <span id="id13">[<a class="reference internal" href="references.html#id12" title="Karl J. Friston, Steven Williams, Robert Howard, Richard S. J. Frackowiak, and Robert Turner. Movement-Related effects in fMRI time-series. Magnetic Resonance in Medicine, 35(3):346–355, 1996. doi:10.1002/mrm.1910350312.">Friston <em>et al.</em>, 1996</a>]</span>.
<strong>Non-grey matter tissue signal</strong> (such as <em>white matter</em> and <em>cerebrospinal fluid</em>), unlikely to reflect neuronal activity <span id="id14">[<a class="reference internal" href="references.html#id13" title="Michael D. Fox, Abraham Z. Snyder, Justin L. Vincent, Maurizio Corbetta, David C. Van Essen, and Marcus E. Raichle. The human brain is intrinsically organized into dynamic, anticorrelated functional networks. Proceedings of the National Academy of Sciences, 102(27):9673-9678, 2005. doi:10.1073/pnas.0504136102.">Fox <em>et al.</em>, 2005</a>]</span>,
is captured by averaging signals within anatomically-derived masks.
<strong>Global signal</strong> is calculated by averaging signal within the <em>full brain</em> mask <span id="id15">[<a class="reference internal" href="references.html#id13" title="Michael D. Fox, Abraham Z. Snyder, Justin L. Vincent, Maurizio Corbetta, David C. Van Essen, and Marcus E. Raichle. The human brain is intrinsically organized into dynamic, anticorrelated functional networks. Proceedings of the National Academy of Sciences, 102(27):9673-9678, 2005. doi:10.1073/pnas.0504136102.">Fox <em>et al.</em>, 2005</a>]</span>.
These three classes of regressors can be expanded to their first temporal derivatives and their quadratic terms <span id="id16">[<a class="reference internal" href="references.html#id21" title="Theodore D. Satterthwaite, Mark A. Elliott, Raphael T. Gerraty, Kosha Ruparel, James Loughead, Monica E. Calkins, Simon B. Eickhoff, Hakon Hakonarson, Ruben C. Gur, Raquel E. Gur, and Daniel H. Wolf. An improved framework for confound regression and filtering for control of motion artifact in the preprocessing of resting-state functional connectivity data. NeuroImage, 64:240-256, 2013. doi:https://doi.org/10.1016/j.neuroimage.2012.08.052.">Satterthwaite <em>et al.</em>, 2013</a>]</span> to module the non-linear impact of noise.
Full expansion of head motion parameters is often required for optimal denoising results.
<strong>Scrubbing</strong> <span id="id17">[<a class="reference internal" href="references.html#id14" title="Jonathan D. Power, Kelly A. Barnes, Abraham Z. Snyder, Bradley L. Schlaggar, and Steven E. Petersen. Spurious but systematic correlations in functional connectivity MRI networks arise from subject motion. NeuroImage, 59(3):2142–2154, 2012. doi:10.1016/j.neuroimage.2011.10.018.">Power <em>et al.</em>, 2012</a>]</span> is a volume censoring approach to remove high motion segments in which the framewise displacement
(see section <a class="reference internal" href="methods.html#framewise-displacement"><span class="std std-ref">Participant exclusion based on motion</span></a>)
exceeds some threshold.
The scrubbing approach is applied alongside head motion parameters and tissue signal regressors.
<strong>Temporal high-pass filtering</strong> accounts for low-frequency signal drifts introduced by <em>physiological and scanner noise sources</em>.
Aside from regressors directly modeling noise derived from realignment measures or anatomical properties,
other approaches capture the impact of motion and non-neuronal physiological activity through data-driven methods.
The principal component-based method <strong>CompCor</strong> <span id="id18">[<a class="reference internal" href="references.html#id15" title="Yashar Behzadi, Khaled Restom, Joy Liau, and Thomas T. Liu. A component based noise correction method (compcor) for bold and perfusion based fmri. NeuroImage, 37(1):90-101, 2007. doi:10.1016/j.neuroimage.2007.04.042.">Behzadi <em>et al.</em>, 2007</a>, <a class="reference internal" href="references.html#id16" title="John Muschelli, Mary Beth Nebel, Brian S. Caffo, Anita D. Barber, James J. Pekar, and Stewart H. Mostofsky. Reduction of motion-related artifacts in resting state fMRI using aCompCor. NeuroImage, 96:22–35, August 2014. doi:10.1016/j.neuroimage.2014.03.028.">Muschelli <em>et al.</em>, 2014</a>]</span> extracts principal components from white matter and cerebrospinal fluid masks to estimate non-neuronal activity.
Independent component analysis-based methods estimate spatial independent components representing brain activity and/or noise,
and then identify the components related to head-motion through using a data-driven classifier (<strong>ICA-FIX</strong> <span id="id19">[<a class="reference internal" href="references.html#id57" title="Gholamreza Salimi-Khorshidi, Gwenaëlle Douaud, Christian F. Beckmann, Matthew F. Glasser, Ludovica Griffanti, and Stephen M. Smith. Automatic denoising of functional MRI data: Combining independent component analysis and hierarchical fusion of classifiers. NeuroImage, 90:449–468, April 2014. doi:10.1016/j.neuroimage.2013.11.046.">Salimi-Khorshidi <em>et al.</em>, 2014</a>]</span>)
or a pre-trained model (<strong>ICA-AROMA</strong> <span id="id20">[<a class="reference internal" href="references.html#id56" title="Raimon H. R. Pruim, Maarten Mennes, Daan van Rooij, Alberto Llera, Jan K. Buitelaar, and Christian F. Beckmann. Ica-AROMA: a robust ICA-based strategy for removing motion artifacts from fmri data. NeuroImage, 112(Supplement C):267-277, 2015. URL: http://www.sciencedirect.com/science/article/pii/S1053811915001822, doi:10.1016/j.neuroimage.2015.02.064.">Pruim <em>et al.</em>, 2015</a>]</span>).</p>
<p>A denoising approach often involves combining a few classes of regressors described above.
Head motion combined with non-grey matter tissue signal is one of the most basic approaches <span id="id21">[<a class="reference internal" href="references.html#id13" title="Michael D. Fox, Abraham Z. Snyder, Justin L. Vincent, Maurizio Corbetta, David C. Van Essen, and Marcus E. Raichle. The human brain is intrinsically organized into dynamic, anticorrelated functional networks. Proceedings of the National Academy of Sciences, 102(27):9673-9678, 2005. doi:10.1073/pnas.0504136102.">Fox <em>et al.</em>, 2005</a>]</span>.
Scrubbing combines the basic approach above with volume censoring.
Anatomical CompCor regressors are applied along with the basic head motion parameters <span id="id22">[<a class="reference internal" href="references.html#id16" title="John Muschelli, Mary Beth Nebel, Brian S. Caffo, Anita D. Barber, James J. Pekar, and Stewart H. Mostofsky. Reduction of motion-related artifacts in resting state fMRI using aCompCor. NeuroImage, 96:22–35, August 2014. doi:10.1016/j.neuroimage.2014.03.028.">Muschelli <em>et al.</em>, 2014</a>]</span>.
ICA-AROMA requires further denoising using the basic average of white matter and cerebrospinal fluid signal after the initial independent component denoising <span id="id23">[<a class="reference internal" href="references.html#id56" title="Raimon H. R. Pruim, Maarten Mennes, Daan van Rooij, Alberto Llera, Jan K. Buitelaar, and Christian F. Beckmann. Ica-AROMA: a robust ICA-based strategy for removing motion artifacts from fmri data. NeuroImage, 112(Supplement C):267-277, 2015. URL: http://www.sciencedirect.com/science/article/pii/S1053811915001822, doi:10.1016/j.neuroimage.2015.02.064.">Pruim <em>et al.</em>, 2015</a>]</span>.</p>
<p>Different strategies have particular strengths and limitations,
and researchers can make their own choices based on the properties of their data and the limitation of the denoising approaches.
One of the major concerns is the loss in temporal degrees of freedom, leading to the loss of statistical power.
The more loss in temporal degrees of freedom, the less power the remaining data would have to explain the effects.
The full expansion of head motion, white matter, cerebrospinal fluid, and global signal parameters consists of 36 parameters.
Scrubbing has been shown to mitigate the impact of framewise displacement on the functional connectome,
but removing volumes prevents analysis from focusing on frequency characteristics or dynamic changes in fMRI signal, and reduces the temporal degrees of freedom.
Data-decomposition approaches, such as ICA-AROMA and CompCor, were proposed to preserve statistical power in the data.
These approaches aim to reduce the number of nuisance regressors parameters, <!-- I found this hard to believe (after doing the benchmark), but this statement is in both compcor and the ica paper-->
gain better denoising results without volume censoring,
as well as avoiding potentially overfitting the data and removing meaningful signal <span id="id24">[<a class="reference internal" href="references.html#id15" title="Yashar Behzadi, Khaled Restom, Joy Liau, and Thomas T. Liu. A component based noise correction method (compcor) for bold and perfusion based fmri. NeuroImage, 37(1):90-101, 2007. doi:10.1016/j.neuroimage.2007.04.042.">Behzadi <em>et al.</em>, 2007</a>, <a class="reference internal" href="references.html#id17" title="Raimon H. R. Pruim, Maarten Mennes, Jan K. Buitelaar, and Christian F. Beckmann. Evaluation of ICA-AROMA and alternative strategies for motion artifact removal in resting state fMRI. NeuroImage, 112:278–287, May 2015. doi:10.1016/j.neuroimage.2015.02.063.">Pruim <em>et al.</em>, 2015</a>, <a class="reference internal" href="references.html#id56" title="Raimon H. R. Pruim, Maarten Mennes, Daan van Rooij, Alberto Llera, Jan K. Buitelaar, and Christian F. Beckmann. Ica-AROMA: a robust ICA-based strategy for removing motion artifacts from fmri data. NeuroImage, 112(Supplement C):267-277, 2015. URL: http://www.sciencedirect.com/science/article/pii/S1053811915001822, doi:10.1016/j.neuroimage.2015.02.064.">Pruim <em>et al.</em>, 2015</a>]</span>.
However, these methods have their own disadvantages.
ICA-AROMA and CompCor can lead to an inconsistent number of remaining degrees of freedom as the number of components applied to each subject can vary.
Past research has also reported that CompCor may only be viable in low-motion data <span id="id25">[<a class="reference internal" href="references.html#id20" title="Linden Parkes, Ben Fulcher, Murat Yücel, and Alex Fornito. An evaluation of the efficacy, reliability, and sensitivity of motion correction strategies for resting-state functional mri. NeuroImage, 171:415–436, May 2018. doi:10.1016/j.neuroimage.2017.12.073.">Parkes <em>et al.</em>, 2018</a>]</span>.</p>
</div>
<div class="section" id="implementation-of-denoising-step">
<h2>Implementation of denoising step<a class="headerlink" href="#implementation-of-denoising-step" title="Permalink to this headline">#</a></h2>
<!-- aim of the paragraph: How denoising is traditionally done in propriatory software -->
<p>Which approach to adopt is straightforward when users use preprocessing software with statistical modeling functionality.
Each software implements its own preferred strategy,
for instance, FSL adds the motion parameters by default and provides an option to run ICA-AROMA.
The noise regressors are preselected,
and thus user intervention is avoided.
However, when users wish to use additional regressors, the process can be complicated.
With the recent benchmark papers on confound denoising highlighting methods such as ICA-AROMA and CompCor <span id="id26">[<a class="reference internal" href="references.html#id18" title="Rastko Ciric, Daniel H. Wolf, Jonathan D. Power, David R. Roalf, Graham L. Baum, Kosha Ruparel, Russell T. Shinohara, Mark A. Elliott, Simon B. Eickhoff, Christos Davatzikos, Ruben C. Gur, Raquel E. Gur, Danielle S. Bassett, and Theodore D. Satterthwaite. Benchmarking of participant-level confound regression strategies for the control of motion artifact in studies of functional connectivity. NeuroImage, 154(1):174–187, July 2017. doi:10.1016/j.neuroimage.2017.03.020.">Ciric <em>et al.</em>, 2017</a>, <a class="reference internal" href="references.html#id20" title="Linden Parkes, Ben Fulcher, Murat Yücel, and Alex Fornito. An evaluation of the efficacy, reliability, and sensitivity of motion correction strategies for resting-state functional mri. NeuroImage, 171:415–436, May 2018. doi:10.1016/j.neuroimage.2017.12.073.">Parkes <em>et al.</em>, 2018</a>]</span>,
it’s not uncommon for users to want to add parameters other than the native options from a given software.
In the FSL example, if a user wants to use an unsupported strategy, such as CompCor,
they will have to calculate the regressors and inject them into the workflow manually.</p>
<p>The recent rise of minimal preprocessing pipelines fMRIPrep <span id="id27">[<a class="reference internal" href="references.html#id38" title="Oscar Esteban, Christopher Markiewicz, Ross W Blair, Craig Moodie, Ayse Ilkay Isik, Asier Erramuzpe Aliaga, James Kent, Mathias Goncalves, Elizabeth DuPre, Madeleine Snyder, Hiroyuki Oya, Satrajit Ghosh, Jessey Wright, Joke Durnez, Russell Poldrack, and Krzysztof Jacek Gorgolewski. fMRIPrep: a robust preprocessing pipeline for functional MRI. Nature Methods, 2018. doi:10.1038/s41592-018-0235-4.">Esteban <em>et al.</em>, 2018</a>]</span> has addressed the confound regressor issue from a different angle.
fMRIPrep aims to standardise the established steps of fMRI preprocessing, including registration, slice timing correction, motion correction, and distortion correction.
Their approach leaves the choice of denoising and spatial smoothing to users.
Instead of generating a small subset of confound regressors, fMRIPrep calculates a wide range of regressors that can be extracted from the fMRI data.
The benefit of this approach is that the generation of these regressors is standardised and accessible from the same source.
However, several issues related to how users select the regressors for the denoising step remain.
A common concern is that users unfamiliar with the denoising literature or the fMRIprep documentation may select regressors that are not compatible (e.g. applying melodic ICA components to the ICA-AROMA output),
or miss regressors that should be used together (e.g. discrete cosine-basis regressors should always be applied with CompCor components).
These inappropriate choices may reintroduce noise to the data or produce suboptimal denoising results.
In addition, there is no standard way of tracking a user’s choice of regressors,
making replication of other’s denoising steps more difficult.
Lastly, denoising benchmark literature has thus far been performed on study-specific preprocessing pipelines,
and so the validity of these results on fMRIPrep has yet to be examined.</p>
</div>
<div class="section" id="aim-of-the-benchmark">
<h2>Aim of the benchmark<a class="headerlink" href="#aim-of-the-benchmark" title="Permalink to this headline">#</a></h2>
<p>The current work aims to introduce an application programming interface (API) to standardise user interaction with fMRIPrep and provide a benchmark using functional connectivity generated from resting-state data.
We selected two datasets on OpenNeuro for the current analysis:
<code class="docutils literal notranslate"><span class="pre">ds000228</span></code> <span id="id28">[<a class="reference internal" href="references.html#id30" title="Hilary Richardson, Grace Lisandrelli, Alexa Riobueno-Naylor, and Rebecca Saxe. &quot;mri data of 3-12 year old children and adults during viewing of a short animated film&quot;. 2019. doi:10.18112/openneuro.ds000228.v1.1.0.">Richardson <em>et al.</em>, 2019</a>]</span> and <code class="docutils literal notranslate"><span class="pre">ds000030</span></code> <span id="id29">[<a class="reference internal" href="references.html#id29" title="R Bilder, R Poldrack, T Cannon, E London, N Freimer, E Congdon, K Karlsgodt, and F Sabb. &quot;ucla consortium for neuropsychiatric phenomics la5c study&quot;. 2020. doi:10.18112/openneuro.ds000030.v1.0.0.">Bilder <em>et al.</em>, 2020</a>]</span>.
<code class="docutils literal notranslate"><span class="pre">ds000228</span></code> contains adult and child samples, and <code class="docutils literal notranslate"><span class="pre">ds000030</span></code> includes psychiatric conditions.
The benchmark will systematically evaluate the impact of common denoising strategies,
their impact on different types of samples,
and select the best approach for a dataset,
providing a useful reference for fMRIPrep users.
The code base accompanying this project can be re-executed with different versions of fMRIPrep,
and all material can serve as a foundation to generate connectome-based metric quality reports.
The API is released under the popular Python neuroimaging analytic library <code class="docutils literal notranslate"><span class="pre">nilearn</span></code>,
with the aim of maximising the exposure of the API to the larger Python fMRI community.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./research_report"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../index.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Abstract</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="methods.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Methods</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Hao-Ting Wang, Natasha Clarke,Steven L Meisler, Hanad Sharmarke, François Paugam, Nicolas Gensollen, Bertrand Thirion, Christopher J Markiewicz, Pierre Bellec<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>