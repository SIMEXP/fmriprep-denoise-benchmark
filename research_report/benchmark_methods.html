
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Benchmark methods &#8212; Maintainable implementation of re-executable benchmark to track changes overtime</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Results" href="results.html" />
    <link rel="prev" title="Software implementation" href="software_implemetation.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint">⚠️This is a working draft for discussion and feedback!⚠️</div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Maintainable implementation of re-executable benchmark to track changes overtime</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Abstract
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Research report
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="introductions.html">
   Introductions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="software_implemetation.html">
   Software implementation
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Benchmark methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="results.html">
   Results
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="discussions.html">
   Discussions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="contributions.html">
   Contributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="references.html">
   References
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendices and supplemental material
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../supplementary_materials/CITATION.html">
   fMRIPrep preprocessing details
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../supplementary_materials/results_full-sample.html">
   Full sample motion profile and loss in degrees of freedom
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../supplementary_materials/report_ds000228.html">
   ds000228
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../supplementary_materials/report_ds000030.html">
   ds000030
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../supplementary_materials/ohbm2022abstract.html">
   OHBM 2022 abstract - submitted text
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Workflow documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/tldr.html">
   Quick start
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/setup.html">
   Setup to run all customised scripts for preprocessing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/fmriprep.html">
   Preprocessing fMRI data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/timeseires_metrics.html">
   Generate the reports
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/SIMEXP/fmriprep-denoise-benchmark/main?urlpath=tree/content/research_report/benchmark_methods.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/SIMEXP/fmriprep-denoise-benchmark"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/SIMEXP/fmriprep-denoise-benchmark/issues/new?title=Issue%20on%20page%20%2Fresearch_report/benchmark_methods.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/research_report/benchmark_methods.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="../_sources/research_report/benchmark_methods.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#datasets">
   Datasets
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fmri-data-preprocessing">
   fMRI data preprocessing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#choice-of-atlases">
   Choice of atlases
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#participant-exclusion-based-on-motion">
   Participant exclusion based on motion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#confound-regression-strategies">
   Confound regression strategies
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#evaluation-of-the-outcome-of-denoising-strategies">
   Evaluation of the outcome of denoising strategies
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loss-in-temporal-degrees-of-freedom">
     Loss in temporal degrees of freedom
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#quality-control-functional-connectivity-qc-fc">
     Quality control / functional connectivity (QC-FC)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#distance-dependent-effects-of-motion-on-connectivity">
     Distance-dependent effects of motion on connectivity
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#network-modularity">
     Network modularity
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#benchmark-workflow">
   Benchmark workflow
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Benchmark methods</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#datasets">
   Datasets
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fmri-data-preprocessing">
   fMRI data preprocessing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#choice-of-atlases">
   Choice of atlases
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#participant-exclusion-based-on-motion">
   Participant exclusion based on motion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#confound-regression-strategies">
   Confound regression strategies
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#evaluation-of-the-outcome-of-denoising-strategies">
   Evaluation of the outcome of denoising strategies
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loss-in-temporal-degrees-of-freedom">
     Loss in temporal degrees of freedom
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#quality-control-functional-connectivity-qc-fc">
     Quality control / functional connectivity (QC-FC)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#distance-dependent-effects-of-motion-on-connectivity">
     Distance-dependent effects of motion on connectivity
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#network-modularity">
     Network modularity
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#benchmark-workflow">
   Benchmark workflow
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="benchmark-methods">
<h1>Benchmark methods<a class="headerlink" href="#benchmark-methods" title="Permalink to this headline">#</a></h1>
<div class="section" id="datasets">
<h2>Datasets<a class="headerlink" href="#datasets" title="Permalink to this headline">#</a></h2>
<p>Dataset <code class="docutils literal notranslate"><span class="pre">ds000228</span></code> (N = 155) contains fMRI scans of participants watching a silent version of a Pixar animated movie “Partly Cloudy”.
The dataset includes 33 adult subjects
(Age Mean(s.d.) =  24.8(5.3), range = 18–39; 20 female)
and 122 children subjects
(Age Mean(s.d.) =  6.7(2.3), range = 3.5–12.3; 64 female).
For more information on the dataset please refer to <span id="id1">Richardson <em>et al.</em> [<a class="reference internal" href="references.html#id31" title="Hilary Richardson, Grace Lisandrelli, Alexa Riobueno-Naylor, and Rebecca Saxe. Development of the social brain from age three to twelve years. Nature Communications, 9(1):1027, March 2018. doi:10.1038/s41467-018-03399-2.">2018</a>]</span>.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="kn">from</span> <span class="nn">fmriprep_denoise.visualization</span> <span class="kn">import</span> <span class="n">tables</span><span class="p">,</span> <span class="n">utils</span>

<span class="n">path_root</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_data_root</span><span class="p">()</span>

<span class="n">desc</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">lazy_demographic</span><span class="p">(</span><span class="s1">&#39;ds000228&#39;</span><span class="p">,</span> <span class="n">path_root</span><span class="p">)</span>
<span class="n">desc</span> <span class="o">=</span> <span class="n">desc</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_table_attributes</span><span class="p">(</span><span class="s1">&#39;style=&quot;font-size: 12px&quot;&#39;</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;ds000228_desc&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_6bc41_" style="font-size: 12px">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th class="col_heading level0 col0" >full sample</th>
      <th class="col_heading level0 col1" >adult</th>
      <th class="col_heading level0 col2" >child</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_6bc41_level0_row0" class="row_heading level0 row0" >count</th>
      <td id="T_6bc41_row0_col0" class="data row0 col0" >155.000000</td>
      <td id="T_6bc41_row0_col1" class="data row0 col1" >33.000000</td>
      <td id="T_6bc41_row0_col2" class="data row0 col2" >122.000000</td>
    </tr>
    <tr>
      <th id="T_6bc41_level0_row1" class="row_heading level0 row1" >mean</th>
      <td id="T_6bc41_row1_col0" class="data row1 col0" >10.555189</td>
      <td id="T_6bc41_row1_col1" class="data row1 col1" >24.772727</td>
      <td id="T_6bc41_row1_col2" class="data row1 col2" >6.709461</td>
    </tr>
    <tr>
      <th id="T_6bc41_level0_row2" class="row_heading level0 row2" >std</th>
      <td id="T_6bc41_row2_col0" class="data row2 col0" >8.071957</td>
      <td id="T_6bc41_row2_col1" class="data row2 col1" >5.308521</td>
      <td id="T_6bc41_row2_col2" class="data row2 col2" >2.330938</td>
    </tr>
    <tr>
      <th id="T_6bc41_level0_row3" class="row_heading level0 row3" >min</th>
      <td id="T_6bc41_row3_col0" class="data row3 col0" >3.518138</td>
      <td id="T_6bc41_row3_col1" class="data row3 col1" >18.000000</td>
      <td id="T_6bc41_row3_col2" class="data row3 col2" >3.518138</td>
    </tr>
    <tr>
      <th id="T_6bc41_level0_row4" class="row_heading level0 row4" >25%</th>
      <td id="T_6bc41_row4_col0" class="data row4 col0" >5.300000</td>
      <td id="T_6bc41_row4_col1" class="data row4 col1" >21.000000</td>
      <td id="T_6bc41_row4_col2" class="data row4 col2" >4.895210</td>
    </tr>
    <tr>
      <th id="T_6bc41_level0_row5" class="row_heading level0 row5" >50%</th>
      <td id="T_6bc41_row5_col0" class="data row5 col0" >7.680000</td>
      <td id="T_6bc41_row5_col1" class="data row5 col1" >23.000000</td>
      <td id="T_6bc41_row5_col2" class="data row5 col2" >5.980000</td>
    </tr>
    <tr>
      <th id="T_6bc41_level0_row6" class="row_heading level0 row6" >75%</th>
      <td id="T_6bc41_row6_col0" class="data row6 col0" >10.975000</td>
      <td id="T_6bc41_row6_col1" class="data row6 col1" >28.000000</td>
      <td id="T_6bc41_row6_col2" class="data row6 col2" >8.397500</td>
    </tr>
    <tr>
      <th id="T_6bc41_level0_row7" class="row_heading level0 row7" >max</th>
      <td id="T_6bc41_row7_col0" class="data row7 col0" >39.000000</td>
      <td id="T_6bc41_row7_col1" class="data row7 col1" >39.000000</td>
      <td id="T_6bc41_row7_col2" class="data row7 col2" >12.300000</td>
    </tr>
    <tr>
      <th id="T_6bc41_level0_row8" class="row_heading level0 row8" >n_female</th>
      <td id="T_6bc41_row8_col0" class="data row8 col0" >84.000000</td>
      <td id="T_6bc41_row8_col1" class="data row8 col1" >20.000000</td>
      <td id="T_6bc41_row8_col2" class="data row8 col2" >64.000000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Dataset <code class="docutils literal notranslate"><span class="pre">ds000030</span></code> includes multiple tasks collected from subjects with a variety of neuropsychiatric diagnosis , including ADHD, bipolar disorder, schizophrenia, and healthy controls.
The current analysis focused on the resting-state scans only.
Scans with an instrumental artifact (flagged under column <code class="docutils literal notranslate"><span class="pre">ghost_NoGhost</span></code> in <code class="docutils literal notranslate"><span class="pre">participants.tsv</span></code>) were excluded from the analysis pipeline.
Of 272 subjects, 212 entered the preprocessing stage.
Demographic information per condition can be found in <a class="reference internal" href="#table-ds000030"><span class="std std-numref">Table 2</span></a>.</p>
<table class="colwidths-auto table" id="table-ds000030">
<caption><span class="caption-number">Table 2 </span><span class="caption-text">Demographic information of ds000030</span><a class="headerlink" href="#table-ds000030" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="text-align:right head"><p></p></th>
<th class="text-align:right head"><p>Full sample</p></th>
<th class="text-align:right head"><p>Healthy control</p></th>
<th class="text-align:right head"><p>Schizophrenia</p></th>
<th class="text-align:right head"><p>Bipolar disorder</p></th>
<th class="text-align:right head"><p>ADHD</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:right"><p>N(female)</p></td>
<td class="text-align:right"><p>212(98)</p></td>
<td class="text-align:right"><p>106(54)</p></td>
<td class="text-align:right"><p>30(8)</p></td>
<td class="text-align:right"><p>41(19)</p></td>
<td class="text-align:right"><p>35(17)</p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>Age Mean(s.d.)</p></td>
<td class="text-align:right"><p>33.2(9.3)</p></td>
<td class="text-align:right"><p>31.8(8.9)</p></td>
<td class="text-align:right"><p>37.2 (9.2)</p></td>
<td class="text-align:right"><p>34.7 (8.9)</p></td>
<td class="text-align:right"><p>32.5 (10.2)</p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p>Age Range</p></td>
<td class="text-align:right"><p>21–50</p></td>
<td class="text-align:right"><p>21–50</p></td>
<td class="text-align:right"><p>22–49</p></td>
<td class="text-align:right"><p>21–50</p></td>
<td class="text-align:right"><p>21–50</p></td>
</tr>
</tbody>
</table>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">desc</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">lazy_demographic</span><span class="p">(</span><span class="s1">&#39;ds000030&#39;</span><span class="p">,</span> <span class="n">path_root</span><span class="p">)</span>
<span class="n">desc</span> <span class="o">=</span> <span class="n">desc</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_table_attributes</span><span class="p">(</span><span class="s1">&#39;style=&quot;font-size: 12px&quot;&#39;</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;ds000030_desc&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_9b145_" style="font-size: 12px">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th class="col_heading level0 col0" >full sample</th>
      <th class="col_heading level0 col1" >control</th>
      <th class="col_heading level0 col2" >ADHD</th>
      <th class="col_heading level0 col3" >bipolar</th>
      <th class="col_heading level0 col4" >schizophrenia</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_9b145_level0_row0" class="row_heading level0 row0" >count</th>
      <td id="T_9b145_row0_col0" class="data row0 col0" >212.000000</td>
      <td id="T_9b145_row0_col1" class="data row0 col1" >106.000000</td>
      <td id="T_9b145_row0_col2" class="data row0 col2" >35.000000</td>
      <td id="T_9b145_row0_col3" class="data row0 col3" >41.000000</td>
      <td id="T_9b145_row0_col4" class="data row0 col4" >30.000000</td>
    </tr>
    <tr>
      <th id="T_9b145_level0_row1" class="row_heading level0 row1" >mean</th>
      <td id="T_9b145_row1_col0" class="data row1 col0" >33.231132</td>
      <td id="T_9b145_row1_col1" class="data row1 col1" >31.773585</td>
      <td id="T_9b145_row1_col2" class="data row1 col2" >32.485714</td>
      <td id="T_9b145_row1_col3" class="data row1 col3" >34.731707</td>
      <td id="T_9b145_row1_col4" class="data row1 col4" >37.200000</td>
    </tr>
    <tr>
      <th id="T_9b145_level0_row2" class="row_heading level0 row2" >std</th>
      <td id="T_9b145_row2_col0" class="data row2 col0" >9.287324</td>
      <td id="T_9b145_row2_col1" class="data row2 col1" >8.861133</td>
      <td id="T_9b145_row2_col2" class="data row2 col2" >10.190455</td>
      <td id="T_9b145_row2_col3" class="data row2 col3" >8.919149</td>
      <td id="T_9b145_row2_col4" class="data row2 col4" >9.159130</td>
    </tr>
    <tr>
      <th id="T_9b145_level0_row3" class="row_heading level0 row3" >min</th>
      <td id="T_9b145_row3_col0" class="data row3 col0" >21.000000</td>
      <td id="T_9b145_row3_col1" class="data row3 col1" >21.000000</td>
      <td id="T_9b145_row3_col2" class="data row3 col2" >21.000000</td>
      <td id="T_9b145_row3_col3" class="data row3 col3" >21.000000</td>
      <td id="T_9b145_row3_col4" class="data row3 col4" >22.000000</td>
    </tr>
    <tr>
      <th id="T_9b145_level0_row4" class="row_heading level0 row4" >25%</th>
      <td id="T_9b145_row4_col0" class="data row4 col0" >25.000000</td>
      <td id="T_9b145_row4_col1" class="data row4 col1" >24.000000</td>
      <td id="T_9b145_row4_col2" class="data row4 col2" >24.000000</td>
      <td id="T_9b145_row4_col3" class="data row4 col3" >26.000000</td>
      <td id="T_9b145_row4_col4" class="data row4 col4" >29.250000</td>
    </tr>
    <tr>
      <th id="T_9b145_level0_row5" class="row_heading level0 row5" >50%</th>
      <td id="T_9b145_row5_col0" class="data row5 col0" >31.000000</td>
      <td id="T_9b145_row5_col1" class="data row5 col1" >29.000000</td>
      <td id="T_9b145_row5_col2" class="data row5 col2" >29.000000</td>
      <td id="T_9b145_row5_col3" class="data row5 col3" >35.000000</td>
      <td id="T_9b145_row5_col4" class="data row5 col4" >39.500000</td>
    </tr>
    <tr>
      <th id="T_9b145_level0_row6" class="row_heading level0 row6" >75%</th>
      <td id="T_9b145_row6_col0" class="data row6 col0" >41.000000</td>
      <td id="T_9b145_row6_col1" class="data row6 col1" >39.750000</td>
      <td id="T_9b145_row6_col2" class="data row6 col2" >40.000000</td>
      <td id="T_9b145_row6_col3" class="data row6 col3" >42.000000</td>
      <td id="T_9b145_row6_col4" class="data row6 col4" >44.750000</td>
    </tr>
    <tr>
      <th id="T_9b145_level0_row7" class="row_heading level0 row7" >max</th>
      <td id="T_9b145_row7_col0" class="data row7 col0" >50.000000</td>
      <td id="T_9b145_row7_col1" class="data row7 col1" >50.000000</td>
      <td id="T_9b145_row7_col2" class="data row7 col2" >50.000000</td>
      <td id="T_9b145_row7_col3" class="data row7 col3" >50.000000</td>
      <td id="T_9b145_row7_col4" class="data row7 col4" >49.000000</td>
    </tr>
    <tr>
      <th id="T_9b145_level0_row8" class="row_heading level0 row8" >n_female</th>
      <td id="T_9b145_row8_col0" class="data row8 col0" >98.000000</td>
      <td id="T_9b145_row8_col1" class="data row8 col1" >54.000000</td>
      <td id="T_9b145_row8_col2" class="data row8 col2" >17.000000</td>
      <td id="T_9b145_row8_col3" class="data row8 col3" >19.000000</td>
      <td id="T_9b145_row8_col4" class="data row8 col4" >8.000000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="fmri-data-preprocessing">
<h2>fMRI data preprocessing<a class="headerlink" href="#fmri-data-preprocessing" title="Permalink to this headline">#</a></h2>
<p>We preprocessed fMRI data using fMRIPrep LTS20.2.1 through <a class="reference external" href="https://github.com/SIMEXP/fmriprep-slurm"><code class="docutils literal notranslate"><span class="pre">fMRIPrep-slurm</span></code></a> with the following options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">aroma</span> \
<span class="o">--</span><span class="n">omp</span><span class="o">-</span><span class="n">nthreads</span> <span class="mi">1</span> \
<span class="o">--</span><span class="n">nprocs</span> <span class="mi">1</span> \
<span class="o">--</span><span class="n">output</span><span class="o">-</span><span class="n">spaces</span> <span class="n">MNI152NLin2009cAsym</span> <span class="n">MNI152NLin6Asym</span> \
<span class="o">--</span><span class="n">output</span><span class="o">-</span><span class="n">layout</span> <span class="n">bids</span> \
<span class="o">--</span><span class="n">notrack</span> \
<span class="o">--</span><span class="n">skip_bids_validation</span> \
<span class="o">--</span><span class="n">write</span><span class="o">-</span><span class="n">graph</span> \
<span class="o">--</span><span class="n">resource</span><span class="o">-</span><span class="n">monitor</span>
</pre></div>
</div>
<p>For the full description generated by fMRIPrep, please see <a class="reference internal" href="../supplementary_materials/CITATION.html"><span class="doc std std-doc">supplemental material</span></a>.</p>
</div>
<div class="section" id="choice-of-atlases">
<h2>Choice of atlases<a class="headerlink" href="#choice-of-atlases" title="Permalink to this headline">#</a></h2>
<p>We extracted time series with regions of interest (ROI) defined by the following atlases:
Gordon atlas <span id="id2">[<a class="reference internal" href="references.html#id34" title="Evan M. Gordon, Timothy O. Laumann, Babatunde Adeyemo, Jeremy F. Huckins, William M. Kelley, and Steven E. Petersen. Generation and Evaluation of a Cortical Area Parcellation from Resting-State Correlations. Cerebral Cortex, 26(1):288-303, 10 2014. doi:10.1093/cercor/bhu239.">Gordon <em>et al.</em>, 2014</a>]</span>,
Schaefer 7 network atlas <span id="id3">[<a class="reference internal" href="references.html#id32" title="Alexander Schaefer, Ru Kong, Evan M. Gordon, Timothy O. Laumann, Xi-Nian Zuo, Avram J. Holmes, Simon B. Eickhoff, and B.T. Thomas Yeo. Local-global parcellation of the human cerebral cortex from intrinsic functional connectivity mri. Cerebral Cortex, pages 1–20, 2017. doi:10.1093/cercor/bhx179.">Schaefer <em>et al.</em>, 2017</a>]</span>,
Multiresolution Intrinsic Segmentation Template (MIST) <span id="id4">[<a class="reference internal" href="references.html#id35" title="Sebastian Urchs, Jonathan Armoza, Clara Moreau, Yassine Benhajali, Jolène St-Aubin, Pierre Orban, and Pierre Bellec. Mist: a multi-resolution parcellation of functional brain networks. MNI Open Research, 1(3):3, 2019.">Urchs <em>et al.</em>, 2019</a>]</span>,
and Dictionary of Functional Modes (DiFuMo)<span id="id5">[<a class="reference internal" href="references.html#id33" title="Kamalaker Dadi, Gaël Varoquaux, Antonia Machlouzarides-Shalit, Krzysztof J. Gorgolewski, Demian Wassermann, Bertrand Thirion, and Arthur Mensch. Fine-grain atlases of functional modes for fmri analysis. NeuroImage, 221:117126, 2020. doi:10.1016/j.neuroimage.2020.117126.">Dadi <em>et al.</em>, 2020</a>]</span>.
All atlases were resampled to the resolution of the preprocessed functional data.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="note admonition">
<p class="admonition-title">Warning message related to masker resampling</p>
<p><a class="reference external" href="https://github.com/nilearn/nilearn/blob/d53169c6af1cbb3db3485c9480a3e7cb31c2537d/nilearn/maskers/nifti_labels_masker.py#L568-L573">See source code</a></p>
</div>
</div>
<p>Since DiFuMo and MIST atlases can include networks with disjointed regions under the same label,
we carried out further ROI extraction.
Labels are presented with the original number of parcels.
and we denote the number of extracted ROI in brackets.
Gordon and Schaefer atlas parcels use isolated ROI,
hence no further extraction was done.
The Schaefer 1000 parcels atlas was excluded since some regions would disappear after resampling the atlas to the shape of the processed fMRI data.</p>
<ul class="simple">
<li><p>Gordon atlas: 333</p></li>
<li><p>Schaefer atlas: 100, 200, 300, 400, 500, 600, 800</p></li>
<li><p>Multiresolution Intrinsic Segmentation Template (MIST) <span id="id6">[<a class="reference internal" href="references.html#id35" title="Sebastian Urchs, Jonathan Armoza, Clara Moreau, Yassine Benhajali, Jolène St-Aubin, Pierre Orban, and Pierre Bellec. Mist: a multi-resolution parcellation of functional brain networks. MNI Open Research, 1(3):3, 2019.">Urchs <em>et al.</em>, 2019</a>]</span>: 7, 12, 20, 36, 64, 122, 197, 325, 444, “ROI” (210 parcels, 122 split by the midline)</p></li>
<li><p>DiFuMo atlas <span id="id7">[<a class="reference internal" href="references.html#id33" title="Kamalaker Dadi, Gaël Varoquaux, Antonia Machlouzarides-Shalit, Krzysztof J. Gorgolewski, Demian Wassermann, Bertrand Thirion, and Arthur Mensch. Fine-grain atlases of functional modes for fmri analysis. NeuroImage, 221:117126, 2020. doi:10.1016/j.neuroimage.2020.117126.">Dadi <em>et al.</em>, 2020</a>]</span>: 64 (114), 128 (200), 256 (372), 512 (637), 1024 (1158)</p></li>
</ul>
<p>Processes involved here are implemented through nilearn <span id="id8">[<a class="reference internal" href="references.html#id60" title="Alexandre Abraham, Fabian Pedregosa, Michael Eickenberg, Philippe Gervais, Andreas Mueller, Jean Kossaifi, Alexandre Gramfort, Bertrand Thirion, and Gael Varoquaux. Machine learning for neuroimaging with scikit-learn. Frontiers in Neuroinformatics, 2014. doi:10.3389/fninf.2014.00014.">Abraham <em>et al.</em>, 2014</a>]</span>.
Time series were extracted using <code class="docutils literal notranslate"><span class="pre">nilearn.maskers.NiftiLabelsMasker</span></code> and <code class="docutils literal notranslate"><span class="pre">nilearn.maskers.NiftiMapsMasker</span></code>.
Connectomes were calculated using Pearson’s Correlation, implemented through <code class="docutils literal notranslate"><span class="pre">nilearn.connectome.ConnectivityMeasure</span></code>.</p>
</div>
<div class="section" id="participant-exclusion-based-on-motion">
<span id="framewise-displacement"></span><h2>Participant exclusion based on motion<a class="headerlink" href="#participant-exclusion-based-on-motion" title="Permalink to this headline">#</a></h2>
<p>We performed data quality control to exclude subjects with excessive motion leading to unusable data.
In the current report, we use framewise displacement as the metric to quantify motion.
Framewise displacement indexes the movement of the head from one volume to the next.
The movement includes the transitions on the three axes (<span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, <span class="math notranslate nohighlight">\(z\)</span>) and the respective rotation (<span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span>, <span class="math notranslate nohighlight">\(\gamma\)</span>).
Rotational displacements are calculated as the displacement on the surface of a sphere of radius 50 mm <span id="id9">[<a class="reference internal" href="references.html#id14" title="Jonathan D. Power, Kelly A. Barnes, Abraham Z. Snyder, Bradley L. Schlaggar, and Steven E. Petersen. Spurious but systematic correlations in functional connectivity MRI networks arise from subject motion. NeuroImage, 59(3):2142–2154, 2012. doi:10.1016/j.neuroimage.2011.10.018.">Power <em>et al.</em>, 2012</a>]</span>.
fMRIPrep generates the dramewise displacement based on the formula proposed in <span id="id10">[<a class="reference internal" href="references.html#id14" title="Jonathan D. Power, Kelly A. Barnes, Abraham Z. Snyder, Bradley L. Schlaggar, and Steven E. Petersen. Spurious but systematic correlations in functional connectivity MRI networks arise from subject motion. NeuroImage, 59(3):2142–2154, 2012. doi:10.1016/j.neuroimage.2011.10.018.">Power <em>et al.</em>, 2012</a>]</span>.
The framewise displacement, denoted as FD, at each time point <span class="math notranslate nohighlight">\(t\)</span> is expressed as:</p>
<div class="math notranslate nohighlight">
\[
\text{FD}_t = |\Delta d_{x,t}| + |\Delta d_{y,t}| +
|\Delta d_{z,t}| + |\Delta \alpha_t| + |\Delta \beta_t| + |\Delta \gamma_t|
\]</div>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fmriprep_denoise.features.derivatives</span> <span class="kn">import</span> <span class="n">get_qc_criteria</span>

<span class="n">stringent</span> <span class="o">=</span> <span class="n">get_qc_criteria</span><span class="p">(</span><span class="s1">&#39;stringent&#39;</span><span class="p">)</span>
<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;gross_fd&#39;</span><span class="p">,</span> <span class="n">stringent</span><span class="p">[</span><span class="s1">&#39;gross_fd&#39;</span><span class="p">])</span>
<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;fd_thresh&#39;</span><span class="p">,</span> <span class="n">stringent</span><span class="p">[</span><span class="s1">&#39;fd_thresh&#39;</span><span class="p">])</span>
<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;proportion_thresh&#39;</span><span class="p">,</span> <span class="n">stringent</span><span class="p">[</span><span class="s1">&#39;proportion_thresh&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To ensure the analysis is performed in a realistic scenario we exclude subjects with high motion,
defined by the following criteria adopted from  <span id="id11">[<a class="reference internal" href="references.html#id20" title="Linden Parkes, Ben Fulcher, Murat Yücel, and Alex Fornito. An evaluation of the efficacy, reliability, and sensitivity of motion correction strategies for resting-state functional mri. NeuroImage, 171:415–436, May 2018. doi:10.1016/j.neuroimage.2017.12.073.">Parkes <em>et al.</em>, 2018</a>]</span>:
mean framewise displacement &gt; <span class="pasted-inline"><code class="output text_plain docutils literal notranslate"><span class="pre">0.25</span></code></span> mm,
above <span class="pasted-inline"><code class="output text_plain docutils literal notranslate"><span class="pre">80.0</span></code></span>% of volumes removed while scrubbing
with a <span class="pasted-inline"><code class="output text_plain docutils literal notranslate"><span class="pre">0.2</span></code></span> mm threshold.</p>
</div>
<div class="section" id="confound-regression-strategies">
<h2>Confound regression strategies<a class="headerlink" href="#confound-regression-strategies" title="Permalink to this headline">#</a></h2>
<p>Confound variables were retrieved using
(i) a basic API that retrieves different classes of confound regressors,
<code class="docutils literal notranslate"><span class="pre">nilearn.interfaces.fmriprep.load_confounds</span></code> (simplified as <code class="docutils literal notranslate"><span class="pre">load_confounds</span></code>);
and (ii) a higher level wrapper to implement common strategies from the denoising literature,
<code class="docutils literal notranslate"><span class="pre">nilearn.interfaces.fmriprep.load_confounds_strategy</span></code>(simplified as <code class="docutils literal notranslate"><span class="pre">load_confounds_strategy</span></code>).
The following section describes the logic behind the design of the API.
For documentation of the actual function, please see the latest version of <a class="reference external" href="https://nilearn.github.io/stable/"><code class="docutils literal notranslate"><span class="pre">nilearn</span></code> documentation</a>.</p>
<p>We evaluated common confound regression strategies that are possible through fMRIPrep-generated confound regressors.
The connectome generated from high-pass filtered time series served as a baseline comparison.
Confound variables were accessed using the API <code class="docutils literal notranslate"><span class="pre">load_confounds_strategy</span></code>.
The detailed 11 strategies and a full breakdown of parameters used under the hood is presented in <a class="reference internal" href="#table-examined-strategies"><span class="std std-numref">Table 3</span></a>.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Click to see <a class="reference internal" href="#table-examined-strategies"><span class="std std-numref">Table 3</span></a><div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<table class="colwidths-auto table" id="table-examined-strategies">
<caption><span class="caption-number">Table 3 </span><span class="caption-text">Denoising strategies</span><a class="headerlink" href="#table-examined-strategies" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p class="sd-card-text">strategy</p></th>
<th class="head"><p class="sd-card-text">image</p></th>
<th class="head"><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">high_pass</span></code></p></th>
<th class="head"><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">motion</span></code></p></th>
<th class="head"><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">wm_csf</span></code></p></th>
<th class="head"><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">global_signal</span></code></p></th>
<th class="head"><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">scrub</span></code></p></th>
<th class="head"><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">fd_thresh</span></code></p></th>
<th class="head"><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">compcor</span></code></p></th>
<th class="head"><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">n_compcor</span></code></p></th>
<th class="head"><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">ica_aroma</span></code></p></th>
<th class="head"><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">demean</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p class="sd-card-text">baseline</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-odd"><td><p class="sd-card-text">simple</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-even"><td><p class="sd-card-text">simple+gsr</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-odd"><td><p class="sd-card-text">scrubbing.5</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">0.5</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-even"><td><p class="sd-card-text">scrubbing.5+gsr</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">0.5</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-odd"><td><p class="sd-card-text">scrubbing.2</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">0.2</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-even"><td><p class="sd-card-text">scrubbing.2+gsr</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">0.2</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-odd"><td><p class="sd-card-text">compcor</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">anat_combined</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">all</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-even"><td><p class="sd-card-text">compcor6</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">anat_combined</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">6</span> </code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-odd"><td><p class="sd-card-text">aroma</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">desc-smoothAROMAnonaggr_bold</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-even"><td><p class="sd-card-text">aroma+gsr</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">desc-smoothAROMAnonaggr_bold</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</details></div>
<div class="section" id="evaluation-of-the-outcome-of-denoising-strategies">
<h2>Evaluation of the outcome of denoising strategies<a class="headerlink" href="#evaluation-of-the-outcome-of-denoising-strategies" title="Permalink to this headline">#</a></h2>
<p>We used selected metrics described in the previous literature to evaluate the denoising results
<span id="id12">[<a class="reference internal" href="references.html#id18" title="Rastko Ciric, Daniel H. Wolf, Jonathan D. Power, David R. Roalf, Graham L. Baum, Kosha Ruparel, Russell T. Shinohara, Mark A. Elliott, Simon B. Eickhoff, Christos Davatzikos, Ruben C. Gur, Raquel E. Gur, Danielle S. Bassett, and Theodore D. Satterthwaite. Benchmarking of participant-level confound regression strategies for the control of motion artifact in studies of functional connectivity. NeuroImage, 154(1):174–187, July 2017. doi:10.1016/j.neuroimage.2017.03.020.">Ciric <em>et al.</em>, 2017</a>, <a class="reference internal" href="references.html#id20" title="Linden Parkes, Ben Fulcher, Murat Yücel, and Alex Fornito. An evaluation of the efficacy, reliability, and sensitivity of motion correction strategies for resting-state functional mri. NeuroImage, 171:415–436, May 2018. doi:10.1016/j.neuroimage.2017.12.073.">Parkes <em>et al.</em>, 2018</a>]</span>.</p>
<div class="section" id="loss-in-temporal-degrees-of-freedom">
<h3>Loss in temporal degrees of freedom<a class="headerlink" href="#loss-in-temporal-degrees-of-freedom" title="Permalink to this headline">#</a></h3>
<p>The common analysis and denoising methods are based on linear regression.
Using more nuisance regressors can capture additional sources of noise-related variance in the data and thus improve denoising.
However, this comes at the expense of a loss of temporal degrees of freedom for statistical inference in further analysis.
This is an important point to consider alongside the denoising performance.
There are two factors constraining the degrees of freedom in the signal:
the number of volumes in a scan,
and the number of nuisance regressors used during denoising.
We calculate the number of regressors used for each strategy.
For the scrubbing-based strategy we further calculate the proportion of volume loss to number of volumes in a scan.</p>
</div>
<div class="section" id="quality-control-functional-connectivity-qc-fc">
<h3>Quality control / functional connectivity (QC-FC)<a class="headerlink" href="#quality-control-functional-connectivity-qc-fc" title="Permalink to this headline">#</a></h3>
<p>QC-FC <span id="id13">[<a class="reference internal" href="references.html#id24" title="Jonathan D. Power, Bradley L. Schlaggar, and Steven E. Petersen. Recent progress and outstanding issues in motion correction in resting state fMRI. NeuroImage, 105:536–551, January 2015. doi:10.1016/j.neuroimage.2014.10.044.">Power <em>et al.</em>, 2015</a>]</span> quantifies the correlation between mean framewise displacement and functional connectivity.
This is calculated by a partial correlation between mean framewise displacement and connectivity,
with age and sex as covariates.
The denoising methods should aim to reduce the QC-FC value.
Significance values were corrected for multiple comparisons using the false positive rate.</p>
</div>
<div class="section" id="distance-dependent-effects-of-motion-on-connectivity">
<h3>Distance-dependent effects of motion on connectivity<a class="headerlink" href="#distance-dependent-effects-of-motion-on-connectivity" title="Permalink to this headline">#</a></h3>
<p>To determine the residual distance-dependence of subject movement,
we first calculated the Euclidean distance between the centers of mass of each pair of parcels <span id="id14">[<a class="reference internal" href="references.html#id14" title="Jonathan D. Power, Kelly A. Barnes, Abraham Z. Snyder, Bradley L. Schlaggar, and Steven E. Petersen. Spurious but systematic correlations in functional connectivity MRI networks arise from subject motion. NeuroImage, 59(3):2142–2154, 2012. doi:10.1016/j.neuroimage.2011.10.018.">Power <em>et al.</em>, 2012</a>]</span>.
We then correlated the distance separating each pair of parcels and the associated QC-FC correlation of the edge connecting those parcels.
Closer parcels generally exhibit greater impact of motion on connectivity.
We expect to see a general trend of negative to zero correlation after confound regression.</p>
</div>
<div class="section" id="network-modularity">
<h3>Network modularity<a class="headerlink" href="#network-modularity" title="Permalink to this headline">#</a></h3>
<p>Confound regressors have the potential to remove real signals in addition to motion-related noise.
In order to evaluate this possibility,
we computed modularity quality,
an explicit quantification of the degree to which there are structured sub-networks in a given network -
in this case the de-noised connectome <span id="id15">[<a class="reference internal" href="references.html#id22" title="Theodore D. Satterthwaite, Daniel H. Wolf, James Loughead, Kosha Ruparel, Mark A. Elliott, Hakonarson Hakon, Ruben C. Gur, and Raquel E. Gur. Impact of In-Scanner Head Motion on Multiple Measures of Functional Connectivity: Relevance for Studies of Neurodevelopment in Youth. NeuroImage, 60(1):623–632, March 2012. doi:10.1016/j.neuroimage.2011.12.063.">Satterthwaite <em>et al.</em>, 2012</a>]</span>.
Modularity quality is quantified by graph community detection based on the Louvain method <span id="id16">[<a class="reference internal" href="references.html#id25" title="Mikail Rubinov and Olaf Sporns. Complex network measures of brain connectivity: uses and interpretations. NeuroImage, 52(3):1059-1069, 2010. doi:10.1016/j.neuroimage.2009.10.003.">Rubinov and Sporns, 2010</a>]</span>,
implemented in the Brain Connectome Toolbox.
If confound regression and censoring were removing real signals in addition to motion-related noise,
we would expect modularity to decline.
To understand the extent of correlation between modularity and motion,
we computed the partial correlation between subjects’ modularity values and mean framewise displacement,
with age and sex as covariates.</p>
</div>
</div>
<div class="section" id="benchmark-workflow">
<h2>Benchmark workflow<a class="headerlink" href="#benchmark-workflow" title="Permalink to this headline">#</a></h2>
<p><a class="reference internal" href="#fig-denoise-benchmark-workflow"><span class="std std-numref">Fig. 2</span></a> presents the graphic summary of the benchmark workflow.</p>
<!-- description TBA -->
<div class="figure align-default" id="fig-denoise-benchmark-workflow">
<a class="reference internal image-reference" href="../_images/denoise-benchmark-workflow.png"><img alt="../_images/denoise-benchmark-workflow.png" src="../_images/denoise-benchmark-workflow.png" style="height: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 2 </span><span class="caption-text">Workflow of generating the full denoising benchmark.</span><a class="headerlink" href="#fig-denoise-benchmark-workflow" title="Permalink to this image">#</a></p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./research_report"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="software_implemetation.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Software implementation</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="results.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Results</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Hao-Ting Wang, Natasha Clarke, Steven L Meisler, Hanad Sharmarke, François Paugam, Nicolas Gensollen, Bertrand Thirion, Christopher J Markiewicz, Pierre Bellec<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>