
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Methods &#8212; Benchmark denoising strategies on fMRIPrep outputs</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Results" href="results.html" />
    <link rel="prev" title="Introductions" href="introductions.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint">⚠️This is a working draft for discussion and feedback!⚠️</div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Benchmark denoising strategies on fMRIPrep outputs</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Abstract
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Research report
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="introductions.html">
   Introductions
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Methods
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="results.html">
   Results
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="report_ds000228.html">
     ds000228
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="report_ds000030.html">
     ds000030
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="discussions.html">
   Discussions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="contributions.html">
   Contributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="references.html">
   References
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendices and supplemental material
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../supplementary_materials/CITATION.html">
   fMRIPrep preprocessing details
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../supplementary_materials/ohbm2022abstract.html">
   OHBM 2022 abstract - submitted text
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../supplementary_materials/walkthrough.html">
   Code documentation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../supplementary_materials/setup.html">
     Setup of this project
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../supplementary_materials/build_book.html">
     Rebuild the book
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/SIMEXP/fmriprep-denoise-benchmark/main?urlpath=tree/content/research_report/methods.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/SIMEXP/fmriprep-denoise-benchmark"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/SIMEXP/fmriprep-denoise-benchmark/issues/new?title=Issue%20on%20page%20%2Fresearch_report/methods.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/research_report/methods.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="../_sources/research_report/methods.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#datasets">
   Datasets
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fmri-data-preprocessing">
   fMRI data preprocessing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#time-series-extraction-and-connectome-generation">
   Time series extraction and connectome generation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#confound-regression-strategies">
   Confound regression strategies
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basic-noise-components">
     Basic noise components
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pre-defined-strategies">
     Pre-defined strategies
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#examined-strategies">
     Examined strategies
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#denoising-evaluation-measures">
   Denoising evaluation measures
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#quality-control-functional-connectivity-qc-fc">
     Quality control / functional connectivity (QC-FC)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#distance-dependent-effects-of-motion-on-connectivity">
     Distance-dependent effects of motion on connectivity
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#network-modularity">
     Network modularity
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Methods</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#datasets">
   Datasets
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fmri-data-preprocessing">
   fMRI data preprocessing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#time-series-extraction-and-connectome-generation">
   Time series extraction and connectome generation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#confound-regression-strategies">
   Confound regression strategies
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basic-noise-components">
     Basic noise components
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pre-defined-strategies">
     Pre-defined strategies
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#examined-strategies">
     Examined strategies
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#denoising-evaluation-measures">
   Denoising evaluation measures
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#quality-control-functional-connectivity-qc-fc">
     Quality control / functional connectivity (QC-FC)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#distance-dependent-effects-of-motion-on-connectivity">
     Distance-dependent effects of motion on connectivity
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#network-modularity">
     Network modularity
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="methods">
<h1>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">#</a></h1>
<div class="section" id="datasets">
<h2>Datasets<a class="headerlink" href="#datasets" title="Permalink to this headline">#</a></h2>
<!-- need to revise the demographic information -->
<p>We selected two datasets on OpenNeuro for the current analysis:
<code class="docutils literal notranslate"><span class="pre">ds000228</span></code> <span id="id1">[<a class="reference internal" href="references.html#id25" title="Hilary Richardson, Grace Lisandrelli, Alexa Riobueno-Naylor, and Rebecca Saxe. &quot;mri data of 3-12 year old children and adults during viewing of a short animated film&quot;. 2019. doi:10.18112/openneuro.ds000228.v1.1.0.">Richardson <em>et al.</em>, 2019</a>]</span> and <code class="docutils literal notranslate"><span class="pre">ds000030</span></code> <span id="id2">[<a class="reference internal" href="references.html#id24" title="R Bilder, R Poldrack, T Cannon, E London, N Freimer, E Congdon, K Karlsgodt, and F Sabb. &quot;ucla consortium for neuropsychiatric phenomics la5c study&quot;. 2020. doi:10.18112/openneuro.ds000030.v1.0.0.">Bilder <em>et al.</em>, 2020</a>]</span>.
Dataset <code class="docutils literal notranslate"><span class="pre">ds000228</span></code> (<span class="math notranslate nohighlight">\(N=155\)</span>) contains fMRI scans of participants watching a silent version of Pixar animated movie “Partly Cloudy”.
The dataset includes 33 adult subjects
(<span class="math notranslate nohighlight">\(Mean_{age}=24.8\)</span>, <span class="math notranslate nohighlight">\(SD_{age}=5.3\)</span>, <span class="math notranslate nohighlight">\(range_{age}: 18-39\)</span>; <span class="math notranslate nohighlight">\(n_{female}=20\)</span>)
and 122 children subjects
(<span class="math notranslate nohighlight">\(Mean_{age}=6.7\)</span>, <span class="math notranslate nohighlight">\(SD_{age}=2.3\)</span>, <span class="math notranslate nohighlight">\(range_{age}: 3.5-12\)</span>; <span class="math notranslate nohighlight">\(n_{female}=64\)</span>)
For more information for the dataset please refers to <span id="id3">Richardson <em>et al.</em> [<a class="reference internal" href="references.html#id26" title="Hilary Richardson, Grace Lisandrelli, Alexa Riobueno-Naylor, and Rebecca Saxe. Development of the social brain from age three to twelve years. Nature Communications, 9(1):1027, March 2018. doi:10.1038/s41467-018-03399-2.">2018</a>]</span>.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="kn">from</span> <span class="nn">fmriprep_denoise.visualization</span> <span class="kn">import</span> <span class="n">tables</span>

<span class="n">desc</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">lazy_demographic</span><span class="p">(</span><span class="s1">&#39;ds000228&#39;</span><span class="p">)</span>
<span class="n">desc</span> <span class="o">=</span> <span class="n">desc</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_table_attributes</span><span class="p">(</span><span class="s1">&#39;style=&quot;font-size: 10px&quot;&#39;</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;ds000228_desc&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>---- repo2data starting ----
/opt/hostedtoolcache/Python/3.7.13/x64/lib/python3.7/site-packages/repo2data
Config from file :
/home/runner/work/fmriprep-denoise-benchmark/fmriprep-denoise-benchmark/binder/data_requirement.json
Destination:
../../inputs/fmrieprep-denoise-paper

Info : Starting to download from zenodo 10.5281/zenodo.6941758 ...
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_2036</span><span class="o">/</span><span class="mf">1930556031.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> 
<span class="ne">----&gt; </span><span class="mi">7</span> <span class="kn">from</span> <span class="nn">fmriprep_denoise.visualization</span> <span class="kn">import</span> <span class="n">tables</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> 
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="n">desc</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">lazy_demographic</span><span class="p">(</span><span class="s1">&#39;ds000228&#39;</span><span class="p">)</span>

<span class="o">~/</span><span class="n">work</span><span class="o">/</span><span class="n">fmriprep</span><span class="o">-</span><span class="n">denoise</span><span class="o">-</span><span class="n">benchmark</span><span class="o">/</span><span class="n">fmriprep</span><span class="o">-</span><span class="n">denoise</span><span class="o">-</span><span class="n">benchmark</span><span class="o">/</span><span class="n">fmriprep_denoise</span><span class="o">/</span><span class="n">visualization</span><span class="o">/</span><span class="n">tables</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> 
<span class="ne">----&gt; </span><span class="mi">8</span> <span class="kn">from</span> <span class="nn">fmriprep_denoise.visualization</span> <span class="kn">import</span> <span class="n">utils</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> 
<span class="g g-Whitespace">     </span><span class="mi">10</span> 

<span class="o">~/</span><span class="n">work</span><span class="o">/</span><span class="n">fmriprep</span><span class="o">-</span><span class="n">denoise</span><span class="o">-</span><span class="n">benchmark</span><span class="o">/</span><span class="n">fmriprep</span><span class="o">-</span><span class="n">denoise</span><span class="o">-</span><span class="n">benchmark</span><span class="o">/</span><span class="n">fmriprep_denoise</span><span class="o">/</span><span class="n">visualization</span><span class="o">/</span><span class="n">utils</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">53</span> 
<span class="g g-Whitespace">     </span><span class="mi">54</span> 
<span class="ne">---&gt; </span><span class="mi">55</span> <span class="n">path_root</span> <span class="o">=</span> <span class="n">get_data_root</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">56</span> 
<span class="g g-Whitespace">     </span><span class="mi">57</span> 

<span class="nn">~/work/fmriprep-denoise-benchmark/fmriprep-denoise-benchmark/fmriprep_denoise/visualization/utils.py</span> in <span class="ni">get_data_root</span><span class="nt">()</span>
<span class="g g-Whitespace">     </span><span class="mi">50</span>         <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parents</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="s1">&#39;inputs&#39;</span> <span class="o">/</span> <span class="s1">&#39;fmrieprep-denoise-paper&#39;</span>
<span class="g g-Whitespace">     </span><span class="mi">51</span>     <span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">52</span>     <span class="k">return</span> <span class="n">default_path</span> <span class="k">if</span> <span class="n">default_path</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="k">else</span> <span class="n">repo2data_path</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">53</span> 
<span class="g g-Whitespace">     </span><span class="mi">54</span> 

<span class="nn">~/work/fmriprep-denoise-benchmark/fmriprep-denoise-benchmark/fmriprep_denoise/visualization/utils.py</span> in <span class="ni">repo2data_path</span><span class="nt">()</span>
<span class="g g-Whitespace">     </span><span class="mi">42</span>     <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span>     <span class="n">repo2data</span> <span class="o">=</span> <span class="n">Repo2Data</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data_req_path</span><span class="p">))</span>
<span class="ne">---&gt; </span><span class="mi">44</span>     <span class="n">data_path</span> <span class="o">=</span> <span class="n">repo2data</span><span class="o">.</span><span class="n">install</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">45</span>     <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">data_path</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="g g-Whitespace">     </span><span class="mi">46</span> 

<span class="nn">/opt/hostedtoolcache/Python/3.7.13/x64/lib/python3.7/site-packages/repo2data/repo2data.py</span> in <span class="ni">install</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">103</span>         <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">104</span>             <span class="n">ret</span> <span class="o">+=</span> <span class="p">[</span><span class="n">Repo2DataChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_requirement_file</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">105</span>                                    <span class="bp">self</span><span class="o">.</span><span class="n">_use_server</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_requirement_path</span><span class="p">)</span><span class="o">.</span><span class="n">install</span><span class="p">()]</span>
<span class="g g-Whitespace">    </span><span class="mi">106</span> 
<span class="g g-Whitespace">    </span><span class="mi">107</span>         <span class="k">return</span> <span class="n">ret</span>

<span class="nn">/opt/hostedtoolcache/Python/3.7.13/x64/lib/python3.7/site-packages/repo2data/repo2data.py</span> in <span class="ni">install</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">333</span>                 <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dst_path</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">334</span>             <span class="c1"># Downloading with the right method, depending on the src type</span>
<span class="ne">--&gt; </span><span class="mi">335</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_scan_dl_type</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">336</span>             <span class="c1"># If needed, decompression of the data</span>
<span class="g g-Whitespace">    </span><span class="mi">337</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_archive_decompress</span><span class="p">()</span>

<span class="nn">/opt/hostedtoolcache/Python/3.7.13/x64/lib/python3.7/site-packages/repo2data/repo2data.py</span> in <span class="ni">_scan_dl_type</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">313</span>         <span class="c1"># or from zenodo ?</span>
<span class="g g-Whitespace">    </span><span class="mi">314</span>         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;.*?(10\.\d</span><span class="si">{4}</span><span class="s2">/zenodo).*?&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_requirement_file</span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">]):</span>
<span class="ne">--&gt; </span><span class="mi">315</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_zenodo_download</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">316</span>         <span class="c1"># or osf</span>
<span class="g g-Whitespace">    </span><span class="mi">317</span>         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;.*?(https://osf.io).*?&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_requirement_file</span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">]):</span>

<span class="nn">/opt/hostedtoolcache/Python/3.7.13/x64/lib/python3.7/site-packages/repo2data/repo2data.py</span> in <span class="ni">_zenodo_download</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">253</span>         <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">254</span>             <span class="n">subprocess</span><span class="o">.</span><span class="n">check_call</span><span class="p">(</span>
<span class="ne">--&gt; </span><span class="mi">255</span>                 <span class="p">[</span><span class="s1">&#39;zenodo_get&#39;</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dst_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_requirement_file</span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">]])</span>
<span class="g g-Whitespace">    </span><span class="mi">256</span>         <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">257</span>             <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: zenodo_get does not appear to be installed&quot;</span><span class="p">)</span>

<span class="nn">/opt/hostedtoolcache/Python/3.7.13/x64/lib/python3.7/subprocess.py</span> in <span class="ni">check_call</span><span class="nt">(*popenargs, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">356</span>     <span class="n">check_call</span><span class="p">([</span><span class="s2">&quot;ls&quot;</span><span class="p">,</span> <span class="s2">&quot;-l&quot;</span><span class="p">])</span>
<span class="g g-Whitespace">    </span><span class="mi">357</span>     <span class="sd">&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">358</span><span class="sd">     retcode = call(*popenargs, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">359</span><span class="sd">     if retcode:</span>
<span class="g g-Whitespace">    </span><span class="mi">360</span><span class="sd">         cmd = kwargs.get(&quot;args&quot;)</span>

<span class="nn">/opt/hostedtoolcache/Python/3.7.13/x64/lib/python3.7/subprocess.py</span> in <span class="ni">call</span><span class="nt">(timeout, *popenargs, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">339</span><span class="sd">     with Popen(*popenargs, **kwargs) as p:</span>
<span class="g g-Whitespace">    </span><span class="mi">340</span><span class="sd">         try:</span>
<span class="ne">--&gt; </span><span class="mi">341</span><span class="sd">             return p.wait(timeout=timeout)</span>
<span class="g g-Whitespace">    </span><span class="mi">342</span><span class="sd">         except:  # Including KeyboardInterrupt, wait handled that.</span>
<span class="g g-Whitespace">    </span><span class="mi">343</span><span class="sd">             p.kill()</span>

<span class="nn">/opt/hostedtoolcache/Python/3.7.13/x64/lib/python3.7/subprocess.py</span> in <span class="ni">wait</span><span class="nt">(self, timeout)</span>
<span class="g g-Whitespace">   </span><span class="mi">1017</span><span class="sd">             endtime = _time() + timeout</span>
<span class="g g-Whitespace">   </span><span class="mi">1018</span><span class="sd">         try:</span>
<span class="ne">-&gt; </span><span class="mi">1019</span><span class="sd">             return self._wait(timeout=timeout)</span>
<span class="g g-Whitespace">   </span><span class="mi">1020</span><span class="sd">         except KeyboardInterrupt:</span>
<span class="g g-Whitespace">   </span><span class="mi">1021</span><span class="sd">             # https://bugs.python.org/issue25942</span>

<span class="nn">/opt/hostedtoolcache/Python/3.7.13/x64/lib/python3.7/subprocess.py</span> in <span class="ni">_wait</span><span class="nt">(self, timeout)</span>
<span class="g g-Whitespace">   </span><span class="mi">1651</span><span class="sd">                         if self.returncode is not None:</span>
<span class="g g-Whitespace">   </span><span class="mi">1652</span><span class="sd">                             break  # Another thread waited.</span>
<span class="ne">-&gt; </span><span class="mi">1653</span><span class="sd">                         (pid, sts) = self._try_wait(0)</span>
<span class="g g-Whitespace">   </span><span class="mi">1654</span><span class="sd">                         # Check the pid and loop as waitpid has been known to</span>
<span class="g g-Whitespace">   </span><span class="mi">1655</span><span class="sd">                         # return 0 even without WNOHANG in odd situations.</span>

<span class="nn">/opt/hostedtoolcache/Python/3.7.13/x64/lib/python3.7/subprocess.py</span> in <span class="ni">_try_wait</span><span class="nt">(self, wait_flags)</span>
<span class="g g-Whitespace">   </span><span class="mi">1609</span><span class="sd">             &quot;&quot;&quot;</span><span class="n">All</span> <span class="n">callers</span> <span class="n">to</span> <span class="n">this</span> <span class="n">function</span> <span class="n">MUST</span> <span class="n">hold</span> <span class="bp">self</span><span class="o">.</span><span class="n">_waitpid_lock</span><span class="o">.</span><span class="s2">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1610</span><span class="s2">             try:</span>
<span class="ne">-&gt; </span><span class="mi">1611</span><span class="s2">                 (pid, sts) = os.waitpid(self.pid, wait_flags)</span>
<span class="g g-Whitespace">   </span><span class="mi">1612</span><span class="s2">             except ChildProcessError:</span>
<span class="g g-Whitespace">   </span><span class="mi">1613</span><span class="s2">                 # This happens if SIGCLD is set to be ignored or waiting</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<p>Dataset <code class="docutils literal notranslate"><span class="pre">ds000030</span></code> includes multiple tasks collected on subjects of a variety of neuropsychiatric diagnostics, including ADHD, bipolar disorder, schizophrenia , and healthy controls.
The current analysis only focused on the resting state scans.
Scans with an instrumental artifact (flagged under column <code class="docutils literal notranslate"><span class="pre">ghost_NoGhost</span></code> in <code class="docutils literal notranslate"><span class="pre">particiapnts.tsv</span></code>) were excluded from the analysis pipeline.
259 out of 272 subjects of were included in the benchmark.
The demographic information per condition is in <a class="reference internal" href="#table-ds000030"><span class="std std-numref">Table 1</span></a>.</p>
<table class="colwidths-auto table" id="table-ds000030">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">Demographic information of ds000030</span><a class="headerlink" href="#table-ds000030" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="text-align:right head"><p></p></th>
<th class="text-align:right head"><p>Full sample</p></th>
<th class="text-align:right head"><p>Healthy control</p></th>
<th class="text-align:right head"><p>Schizophrenia</p></th>
<th class="text-align:right head"><p>Bipolar disorder</p></th>
<th class="text-align:right head"><p>ADHD</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:right"><p>N(female)</p></td>
<td class="text-align:right"><p>259(108)</p></td>
<td class="text-align:right"><p>120(56)</p></td>
<td class="text-align:right"><p>50(12)</p></td>
<td class="text-align:right"><p>49(21)</p></td>
<td class="text-align:right"><p>40(19)</p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>Age Mean(s.d.)</p></td>
<td class="text-align:right"><p>33.3(9.3)</p></td>
<td class="text-align:right"><p>31.7 (8.8)</p></td>
<td class="text-align:right"><p>36.5 (8.9)</p></td>
<td class="text-align:right"><p>35.3 (9.0)</p></td>
<td class="text-align:right"><p>32.1 (10.4)</p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p>Age Range</p></td>
<td class="text-align:right"><p>21–50</p></td>
<td class="text-align:right"><p>21–50</p></td>
<td class="text-align:right"><p>22–49</p></td>
<td class="text-align:right"><p>21–50</p></td>
<td class="text-align:right"><p>21–50</p></td>
</tr>
</tbody>
</table>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">desc</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">lazy_demographic</span><span class="p">(</span><span class="s1">&#39;ds000030&#39;</span><span class="p">)</span>
<span class="n">desc</span> <span class="o">=</span> <span class="n">desc</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_table_attributes</span><span class="p">(</span><span class="s1">&#39;style=&quot;font-size: 10px&quot;&#39;</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;ds000030_desc&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="fmri-data-preprocessing">
<h2>fMRI data preprocessing<a class="headerlink" href="#fmri-data-preprocessing" title="Permalink to this headline">#</a></h2>
<p>We preprocessed with fMRIPrep LTS20.2.1 through <a class="reference external" href="https://github.com/SIMEXP/fmriprep-slurm"><code class="docutils literal notranslate"><span class="pre">fMRIPrep-slurm</span></code></a> with the following options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">aroma</span> \
<span class="o">--</span><span class="n">omp</span><span class="o">-</span><span class="n">nthreads</span> <span class="mi">1</span> \
<span class="o">--</span><span class="n">nprocs</span> <span class="mi">1</span> \
<span class="o">--</span><span class="n">random</span><span class="o">-</span><span class="n">seed</span> <span class="mi">0</span>  \
<span class="o">--</span><span class="n">output</span><span class="o">-</span><span class="n">spaces</span> <span class="n">MNI152NLin2009cAsym</span> <span class="n">MNI152NLin6Asym</span> \
<span class="o">--</span><span class="n">output</span><span class="o">-</span><span class="n">layout</span> <span class="n">bids</span> \
<span class="o">--</span><span class="n">notrack</span> \
<span class="o">--</span><span class="n">skip_bids_validation</span> \
<span class="o">--</span><span class="n">write</span><span class="o">-</span><span class="n">graph</span> \
<span class="o">--</span><span class="n">omp</span><span class="o">-</span><span class="n">nthreads</span> <span class="mi">1</span> \
<span class="o">--</span><span class="n">nprocs</span> <span class="mi">1</span> \
<span class="o">--</span><span class="n">resource</span><span class="o">-</span><span class="n">monitor</span>
</pre></div>
</div>
<p>For the full description generated by fMRIPrep, please see <a class="reference internal" href="../supplementary_materials/CITATION.html"><span class="doc std std-doc">supplemental material</span></a>.</p>
</div>
<div class="section" id="time-series-extraction-and-connectome-generation">
<h2>Time series extraction and connectome generation<a class="headerlink" href="#time-series-extraction-and-connectome-generation" title="Permalink to this headline">#</a></h2>
<p>We extract time series with regions of interest (ROI) defined by the following atlases:
Gordon atlas <span id="id4">[<a class="reference internal" href="references.html#id29" title="Evan M. Gordon, Timothy O. Laumann, Babatunde Adeyemo, Jeremy F. Huckins, William M. Kelley, and Steven E. Petersen. Generation and Evaluation of a Cortical Area Parcellation from Resting-State Correlations. Cerebral Cortex, 26(1):288-303, 10 2014. doi:10.1093/cercor/bhu239.">Gordon <em>et al.</em>, 2014</a>]</span>,
Schaefer 7 network atlas <span id="id5">[<a class="reference internal" href="references.html#id27" title="Alexander Schaefer, Ru Kong, Evan M. Gordon, Timothy O. Laumann, Xi-Nian Zuo, Avram J. Holmes, Simon B. Eickhoff, and B.T. Thomas Yeo. Local-global parcellation of the human cerebral cortex from intrinsic functional connectivity mri. Cerebral Cortex, pages 1–20, 2017. doi:10.1093/cercor/bhx179.">Schaefer <em>et al.</em>, 2017</a>]</span>,
Multiresolution Intrinsic Segmentation Template (MIST) <span id="id6">[<a class="reference internal" href="references.html#id30" title="Sebastian Urchs, Jonathan Armoza, Clara Moreau, Yassine Benhajali, Jolène St-Aubin, Pierre Orban, and Pierre Bellec. Mist: a multi-resolution parcellation of functional brain networks. MNI Open Research, 1(3):3, 2019.">Urchs <em>et al.</em>, 2019</a>]</span>,
and Dictionary of Functional Modes (DiFuMo)<span id="id7">[<a class="reference internal" href="references.html#id28" title="Kamalaker Dadi, Gaël Varoquaux, Antonia Machlouzarides-Shalit, Krzysztof J. Gorgolewski, Demian Wassermann, Bertrand Thirion, and Arthur Mensch. Fine-grain atlases of functional modes for fmri analysis. NeuroImage, 221:117126, 2020. doi:10.1016/j.neuroimage.2020.117126.">Dadi <em>et al.</em>, 2020</a>]</span>.
All atlases were resampled to the resolution of the preprocessed functional data.</p>
<p>Further ROI extraction was done on DiFuMo and MIST,
because area under the same label can be networks with disjointed regions.
We present the labels with the original number of parcel,
and denote the number of extracted ROI in brackets.
Gordon and Schaefer atlas both comes with parcels as isolated ROI hence were applied as it is in the extraction.
Schaefer 1000 parcels atlas was excluded as some regions would be dropped after resampling.</p>
<ul class="simple">
<li><p>Gordon atlas: 333</p></li>
<li><p>Schaefer atlas: 100, 200, 300, 400, 500, 600, 800<a class="footnote-reference brackets" href="#id28" id="id8">1</a></p></li>
<li><p>Multiresolution Intrinsic Segmentation Template (MIST) <span id="id9">[<a class="reference internal" href="references.html#id30" title="Sebastian Urchs, Jonathan Armoza, Clara Moreau, Yassine Benhajali, Jolène St-Aubin, Pierre Orban, and Pierre Bellec. Mist: a multi-resolution parcellation of functional brain networks. MNI Open Research, 1(3):3, 2019.">Urchs <em>et al.</em>, 2019</a>]</span>: 7, 12, 20, 36, 64, 122, 197, 325, 444, “ROI” (210 parcels, 122 split by the midline)</p></li>
<li><p>DiFuMo atlas <span id="id10">[<a class="reference internal" href="references.html#id28" title="Kamalaker Dadi, Gaël Varoquaux, Antonia Machlouzarides-Shalit, Krzysztof J. Gorgolewski, Demian Wassermann, Bertrand Thirion, and Arthur Mensch. Fine-grain atlases of functional modes for fmri analysis. NeuroImage, 221:117126, 2020. doi:10.1016/j.neuroimage.2020.117126.">Dadi <em>et al.</em>, 2020</a>]</span>: 64 (114), 128 (200), 256 (372), 512 (637), 1024 (1158)</p></li>
</ul>
<p>Process involved here are implemented through nilearn <span id="id11">[<a class="reference internal" href="references.html#id53" title="Alexandre Abraham, Fabian Pedregosa, Michael Eickenberg, Philippe Gervais, Andreas Mueller, Jean Kossaifi, Alexandre Gramfort, Bertrand Thirion, and Gael Varoquaux. Machine learning for neuroimaging with scikit-learn. Frontiers in Neuroinformatics, 2014. doi:10.3389/fninf.2014.00014.">Abraham <em>et al.</em>, 2014</a>]</span>.
Time series were extracted using <code class="docutils literal notranslate"><span class="pre">nilearn.maskers.NiftiLabelsMasker</span></code> and <code class="docutils literal notranslate"><span class="pre">nilearn.maskers.NiftiMapsMasker</span></code>.
Connectomes were calculated using Pearson’s Correlations, implemented through <code class="docutils literal notranslate"><span class="pre">nilearn.connectome.ConnectivityMeasure</span></code>.</p>
</div>
<div class="section" id="confound-regression-strategies">
<h2>Confound regression strategies<a class="headerlink" href="#confound-regression-strategies" title="Permalink to this headline">#</a></h2>
<p>Confound variables were retrieved using API
<code class="docutils literal notranslate"><span class="pre">nilearn.interfaces.fmriprep.load_confounds</span></code> (simplified as <code class="docutils literal notranslate"><span class="pre">load_confounds</span></code>),
the basic API that retrieves different classes of confound regressor,
and <code class="docutils literal notranslate"><span class="pre">nilearn.interfaces.fmriprep.load_confounds_strategy</span></code>(simplified as <code class="docutils literal notranslate"><span class="pre">load_confounds_strategy</span></code>),
a higher level wrapper to implement common strategies from the denoising literature.
The current section describes the logic behind the design of API.
For documentation of the actual function, please see the latest version of <code class="docutils literal notranslate"><span class="pre">nilearn</span></code>.</p>
<div class="section" id="basic-noise-components">
<h3>Basic noise components<a class="headerlink" href="#basic-noise-components" title="Permalink to this headline">#</a></h3>
<p>To enable easy confound variables loading from fMRIPrep outputs,
<code class="docutils literal notranslate"><span class="pre">load_confounds</span></code> provides an interface that groups subsets of confound variables into noise components and their parameters.
It is possible to fine-tune a subset of noise components and their parameters through this function.
The implementation will only support fMRIPrep functional derivative directory from the 1.2.x series. The compcor noise component requires 1.4.x series or above.</p>
<!-- Explain the logic of nilearn API mirror the intro -->
<p>Two types of regressors are always loaded with no additional parameters for user customisation:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">high_pass</span></code>: discrete cosines transformation basis regressors to handle low-frequency signal drifts.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">non_steady_state</span></code> denotes volumes collected before the fMRI scanner has reached a stable state.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">motion</span></code>, <code class="docutils literal notranslate"><span class="pre">wm_csf</span></code>, and <code class="docutils literal notranslate"><span class="pre">global_signal</span></code> shares similar expansion options:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">motion</span></code>: head motion estimates translation/rotation (6 parameters).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wm_csf</span></code>: average signal extracted from masks of white matter and cerebrospinal fluids (2 parameters).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">global_signal</span></code>: average signal extracted from brain mask (1 parameters).</p></li>
</ul>
<p>For these three parameters above, user can select from the following four options:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">basic</span></code>: just the original signal (n parameter)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">power2</span></code>: original signal and quadratic term (2 * n parameters)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">derivatives</span></code>: original signal and temporal derivative (2 * n parameters)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">full</span></code>:  original signal + temporal derivatives + quadratic terms + quadratic terms temporal derivatives (4 * n parameters)</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">scrub</span></code> generates mask to exclude volumes with excessive motion <span id="id12">[<a class="reference internal" href="references.html#id14" title="Jonathan D. Power, Kelly A. Barnes, Abraham Z. Snyder, Bradley L. Schlaggar, and Steven E. Petersen. Spurious but systematic correlations in functional connectivity MRI networks arise from subject motion. NeuroImage, 59(3):2142–2154, 2012. doi:10.1016/j.neuroimage.2011.10.018.">Power <em>et al.</em>, 2012</a>]</span>.
Two types of parameters can be used to determined volumes to be excluded.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fd_threshold</span></code>: set the head motion cut-off value determined by framewise displacement approach <span id="id13">[<a class="reference internal" href="references.html#id14" title="Jonathan D. Power, Kelly A. Barnes, Abraham Z. Snyder, Bradley L. Schlaggar, and Steven E. Petersen. Spurious but systematic correlations in functional connectivity MRI networks arise from subject motion. NeuroImage, 59(3):2142–2154, 2012. doi:10.1016/j.neuroimage.2011.10.018.">Power <em>et al.</em>, 2012</a>]</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">std_dvars_threshold</span></code>: set the head motion cut-off value determined by the standard deviation of root mean square approach <span id="id14">[<a class="reference internal" href="references.html#id21" title="Mark Jenkinson, Peter Bannister, Michael Brady, and Stephen Smith. Improved optimization for the robust and accurate linear registration and motion correction of brain images. NeuroImage, 17(2):825-841, 2002. doi:https://doi.org/10.1006/nimg.2002.1132.">Jenkinson <em>et al.</em>, 2002</a>, <a class="reference internal" href="references.html#id14" title="Jonathan D. Power, Kelly A. Barnes, Abraham Z. Snyder, Bradley L. Schlaggar, and Steven E. Petersen. Spurious but systematic correlations in functional connectivity MRI networks arise from subject motion. NeuroImage, 59(3):2142–2154, 2012. doi:10.1016/j.neuroimage.2011.10.018.">Power <em>et al.</em>, 2012</a>]</span>.</p></li>
</ul>
<p>The CompCor <span id="id15">[<a class="reference internal" href="references.html#id15" title="Yashar Behzadi, Khaled Restom, Joy Liau, and Thomas T. Liu. A component based noise correction method (compcor) for bold and perfusion based fmri. NeuroImage, 37(1):90-101, 2007. doi:10.1016/j.neuroimage.2007.04.042.">Behzadi <em>et al.</em>, 2007</a>]</span> approach has two associated parameters</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">compcor</span></code> allows users to select components generated by the temporal approach,
or the anatomical approach with specific details for the mask used in noise signal extraction.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_compcor</span></code> retrieves the number of principle components to retrieve.</p></li>
</ul>
<p>For the ICA-based approach, fMRIPrep implemented ICA-AROMA <span id="id16">[<a class="reference internal" href="references.html#id49" title="Raimon H. R. Pruim, Maarten Mennes, Daan van Rooij, Alberto Llera, Jan K. Buitelaar, and Christian F. Beckmann. Ica-AROMA: a robust ICA-based strategy for removing motion artifacts from fmri data. NeuroImage, 112(Supplement C):267-277, 2015. URL: http://www.sciencedirect.com/science/article/pii/S1053811915001822, doi:10.1016/j.neuroimage.2015.02.064.">Pruim <em>et al.</em>, 2015</a>]</span>.
User must manually enable ICA-AROMA with flag <code class="docutils literal notranslate"><span class="pre">--use-aroma</span></code> when using fMRIPrep.
The parameter <code class="docutils literal notranslate"><span class="pre">ica_aroma</span></code> allows two approaches:</p>
<ol class="simple">
<li><p>Use fMRIPrep output with suffix <code class="docutils literal notranslate"><span class="pre">desc-smoothAROMAnonaggr_bold.nii.gz</span></code>.</p></li>
<li><p>Use noise independent components only. Must be used with output with suffix <code class="docutils literal notranslate"><span class="pre">desc-preproc_bold.nii.gz</span></code>.</p></li>
</ol>
</div>
<div class="section" id="pre-defined-strategies">
<h3>Pre-defined strategies<a class="headerlink" href="#pre-defined-strategies" title="Permalink to this headline">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">load_confounds_strategy</span></code> provides an interface to select confounds based on past literature with limited parameters for user customisation:
<code class="docutils literal notranslate"><span class="pre">simple</span></code> <span id="id17">[<a class="reference internal" href="references.html#id13" title="Michael D. Fox, Abraham Z. Snyder, Justin L. Vincent, Maurizio Corbetta, David C. Van Essen, and Marcus E. Raichle. The human brain is intrinsically organized into dynamic, anticorrelated functional networks. Proceedings of the National Academy of Sciences, 102(27):9673-9678, 2005. doi:10.1073/pnas.0504136102.">Fox <em>et al.</em>, 2005</a>]</span> (motion parameters, and tissue signal),
<code class="docutils literal notranslate"><span class="pre">scrubbing</span></code> <span id="id18">[<a class="reference internal" href="references.html#id14" title="Jonathan D. Power, Kelly A. Barnes, Abraham Z. Snyder, Bradley L. Schlaggar, and Steven E. Petersen. Spurious but systematic correlations in functional connectivity MRI networks arise from subject motion. NeuroImage, 59(3):2142–2154, 2012. doi:10.1016/j.neuroimage.2011.10.018.">Power <em>et al.</em>, 2012</a>]</span>(volume censoring, motion parameters, and tissue signal),
<code class="docutils literal notranslate"><span class="pre">compcor</span></code> <span id="id19">[<a class="reference internal" href="references.html#id15" title="Yashar Behzadi, Khaled Restom, Joy Liau, and Thomas T. Liu. A component based noise correction method (compcor) for bold and perfusion based fmri. NeuroImage, 37(1):90-101, 2007. doi:10.1016/j.neuroimage.2007.04.042.">Behzadi <em>et al.</em>, 2007</a>]</span>(anatomical compcor and motion parameters),
and <code class="docutils literal notranslate"><span class="pre">aroma</span></code> <span id="id20">[<a class="reference internal" href="references.html#id49" title="Raimon H. R. Pruim, Maarten Mennes, Daan van Rooij, Alberto Llera, Jan K. Buitelaar, and Christian F. Beckmann. Ica-AROMA: a robust ICA-based strategy for removing motion artifacts from fmri data. NeuroImage, 112(Supplement C):267-277, 2015. URL: http://www.sciencedirect.com/science/article/pii/S1053811915001822, doi:10.1016/j.neuroimage.2015.02.064.">Pruim <em>et al.</em>, 2015</a>]</span>(ICA-AROMA based denoising, and tissue signal).
All strategies but <code class="docutils literal notranslate"><span class="pre">compcor</span></code> provides an option to add global signal to the confound regressors.</p>
</div>
<div class="section" id="examined-strategies">
<h3>Examined strategies<a class="headerlink" href="#examined-strategies" title="Permalink to this headline">#</a></h3>
<p>We evaluated common confound regression strategies that are possible through fMRIPrep generated confound regressors.
The connectome generated from high-pass filtered time series were served as a comparison baseline.
Confound variables were accessed using API <code class="docutils literal notranslate"><span class="pre">load_confounds_strategy</span></code>.
The detailed 11 strategies and a full breakdown of parameters used under the hood is presented in <a class="reference internal" href="#table-strategies"><span class="std std-numref">Table 2</span></a>.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Click to see <a class="reference internal" href="#table-strategies"><span class="std std-numref">Table 2</span></a><div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<table class="colwidths-auto table" id="table-strategies">
<caption><span class="caption-number">Table 2 </span><span class="caption-text">Denoising strategies</span><a class="headerlink" href="#table-strategies" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p class="sd-card-text">strategy</p></th>
<th class="head"><p class="sd-card-text">image</p></th>
<th class="head"><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">high_pass</span></code></p></th>
<th class="head"><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">motion</span></code></p></th>
<th class="head"><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">wm_csf</span></code></p></th>
<th class="head"><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">global_signal</span></code></p></th>
<th class="head"><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">scrub</span></code></p></th>
<th class="head"><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">fd_thresh</span></code></p></th>
<th class="head"><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">compcor</span></code></p></th>
<th class="head"><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">n_compcor</span></code></p></th>
<th class="head"><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">ica_aroma</span></code></p></th>
<th class="head"><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">demean</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p class="sd-card-text">baseline</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-odd"><td><p class="sd-card-text">simple</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-even"><td><p class="sd-card-text">simple+gsr</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-odd"><td><p class="sd-card-text">scrubbing.5</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">0.5</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-even"><td><p class="sd-card-text">scrubbing.5+gsr</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">0.5</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-odd"><td><p class="sd-card-text">scrubbing.2</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">0.2</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-even"><td><p class="sd-card-text">scrubbing.2+gsr</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">0.2</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-odd"><td><p class="sd-card-text">compcor</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">anat_combined</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">all</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-even"><td><p class="sd-card-text">compcor6</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">desc-preproc_bold</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">anat_combined</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">6</span> </code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-odd"><td><p class="sd-card-text">aroma</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">desc-smoothAROMAnonaggr_bold</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-even"><td><p class="sd-card-text">aroma+gsr</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">desc-smoothAROMAnonaggr_bold</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">basic</span></code></p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text">N/A</p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">full</span></code></p></td>
<td><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</details></div>
</div>
<div class="section" id="denoising-evaluation-measures">
<h2>Denoising evaluation measures<a class="headerlink" href="#denoising-evaluation-measures" title="Permalink to this headline">#</a></h2>
<p>We used selected metrics described in the previous literature to evaluate the denoising results
<span id="id21">[<a class="reference internal" href="references.html#id16" title="Rastko Ciric, Daniel H. Wolf, Jonathan D. Power, David R. Roalf, Graham L. Baum, Kosha Ruparel, Russell T. Shinohara, Mark A. Elliott, Simon B. Eickhoff, Christos Davatzikos, Ruben C. Gur, Raquel E. Gur, Danielle S. Bassett, and Theodore D. Satterthwaite. Benchmarking of participant-level confound regression strategies for the control of motion artifact in studies of functional connectivity. NeuroImage, 154(1):174–187, July 2017. doi:10.1016/j.neuroimage.2017.03.020.">Ciric <em>et al.</em>, 2017</a>, <a class="reference internal" href="references.html#id18" title="Linden Parkes, Ben Fulcher, Murat Yücel, and Alex Fornito. An evaluation of the efficacy, reliability, and sensitivity of motion correction strategies for resting-state functional mri. NeuroImage, 171:415–436, May 2018. doi:10.1016/j.neuroimage.2017.12.073.">Parkes <em>et al.</em>, 2018</a>]</span>.
Motion related metrics are centred around framewise displacement.
Framewise displacement (FD) indexes the movement of the head from one volume to the next.
The movement includes the transitions on the three axes (<span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, <span class="math notranslate nohighlight">\(z\)</span>) and the respective rotation (<span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\beta_t\)</span>, <span class="math notranslate nohighlight">\(\gamma\)</span>).
Rotational displacements are calculated as the displacement on the surface of a sphere of radius 50 mm <span id="id22">[<a class="reference internal" href="references.html#id14" title="Jonathan D. Power, Kelly A. Barnes, Abraham Z. Snyder, Bradley L. Schlaggar, and Steven E. Petersen. Spurious but systematic correlations in functional connectivity MRI networks arise from subject motion. NeuroImage, 59(3):2142–2154, 2012. doi:10.1016/j.neuroimage.2011.10.018.">Power <em>et al.</em>, 2012</a>]</span>.
fMRIPrep genetates the FD based on the formula proposed in <span id="id23">[<a class="reference internal" href="references.html#id14" title="Jonathan D. Power, Kelly A. Barnes, Abraham Z. Snyder, Bradley L. Schlaggar, and Steven E. Petersen. Spurious but systematic correlations in functional connectivity MRI networks arise from subject motion. NeuroImage, 59(3):2142–2154, 2012. doi:10.1016/j.neuroimage.2011.10.018.">Power <em>et al.</em>, 2012</a>]</span>.
The FD at each time point <span class="math notranslate nohighlight">\(t\)</span> is expressed as:</p>
<div class="math notranslate nohighlight">
\[
\text{FD}_t = |\Delta d_{x,t}| + |\Delta d_{y,t}| +
|\Delta d_{z,t}| + |\Delta \alpha_t| + |\Delta \beta_t| + |\Delta \gamma_t|
\]</div>
<p>The details of each measures are explained as followed.</p>
<div class="section" id="quality-control-functional-connectivity-qc-fc">
<h3>Quality control / functional connectivity (QC-FC)<a class="headerlink" href="#quality-control-functional-connectivity-qc-fc" title="Permalink to this headline">#</a></h3>
<p>QC-FC <span id="id24">[<a class="reference internal" href="references.html#id22" title="Jonathan D. Power, Bradley L. Schlaggar, and Steven E. Petersen. Recent progress and outstanding issues in motion correction in resting state fMRI. NeuroImage, 105:536–551, January 2015. doi:10.1016/j.neuroimage.2014.10.044.">Power <em>et al.</em>, 2015</a>]</span> quantifies the correlation between mean FD and functional connectivity.
This is calculated by a partial correlation between mean FD and connectivity with age and sex as covariates.
The denoising methods should aim to reduce the QC-FC value.
The significants values reported are control for multiple comparisons with false positive rate correction.</p>
</div>
<div class="section" id="distance-dependent-effects-of-motion-on-connectivity">
<h3>Distance-dependent effects of motion on connectivity<a class="headerlink" href="#distance-dependent-effects-of-motion-on-connectivity" title="Permalink to this headline">#</a></h3>
<p>To determine the residual distance-dependence of subject movement,
we first calculate the Euclidean distance between the centers of mass of ecah pair of parcels <span id="id25">[<a class="reference internal" href="references.html#id14" title="Jonathan D. Power, Kelly A. Barnes, Abraham Z. Snyder, Bradley L. Schlaggar, and Steven E. Petersen. Spurious but systematic correlations in functional connectivity MRI networks arise from subject motion. NeuroImage, 59(3):2142–2154, 2012. doi:10.1016/j.neuroimage.2011.10.018.">Power <em>et al.</em>, 2012</a>]</span>.
We then correlated the distance separating each pair of parcels and the associated QC-FC correlation of the edge connecting those parcels.
Closer parcels generally exhibiting greater impact of motion on connectivity.
We expect to see a general trend of negative correlation to no correlation after confound regression.</p>
</div>
<div class="section" id="network-modularity">
<h3>Network modularity<a class="headerlink" href="#network-modularity" title="Permalink to this headline">#</a></h3>
<p>Confound regressors has the potential to remove real signal in addition to motion-related noise.
In order to evaluate this possibility, we computed modularity quality,
an explicit quantification of the degree to which there are structured sub-networks in a given network,
in this case the de-noised connectome <span id="id26">[<a class="reference internal" href="references.html#id20" title="Theodore D. Satterthwaite, Daniel H. Wolf, James Loughead, Kosha Ruparel, Mark A. Elliott, Hakonarson Hakon, Ruben C. Gur, and Raquel E. Gur. Impact of In-Scanner Head Motion on Multiple Measures of Functional Connectivity: Relevance for Studies of Neurodevelopment in Youth. NeuroImage, 60(1):623–632, March 2012. doi:10.1016/j.neuroimage.2011.12.063.">Satterthwaite <em>et al.</em>, 2012</a>]</span>.
Modularity quality is quantified by graph community detection based on Louvain method <span id="id27">[<a class="reference internal" href="references.html#id23" title="Mikail Rubinov and Olaf Sporns. Complex network measures of brain connectivity: uses and interpretations. NeuroImage, 52(3):1059-1069, 2010. doi:10.1016/j.neuroimage.2009.10.003.">Rubinov and Sporns, 2010</a>]</span>,
implemented in the Brain Connectome Toolbox.
If confound regression and censoring were removing real signal in addition to motion-related noise,
we expect that modularity would decline.
To understand the extend of correlation between modularity and motion.
we computed the partial correlation between subjects’ modularity values and mean FD,
with age and sex as covariates.</p>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="id28"><span class="brackets"><a class="fn-backref" href="#id8">1</a></span></dt>
<dd><p>When resampling 1000 parcel version of the Schaefer atlas to match the preprocessed data,
some subjects will miss a parcel.</p>
</dd>
</dl>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./research_report"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="introductions.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Introductions</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="results.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Results</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Hao-Ting Wang, Steven L Meisler, Hanad Sharmarke, François Paugam, Nicolas Gensollen, Bertrand Thirion, Christopher J Markiewicz, Pierre Bellec<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>